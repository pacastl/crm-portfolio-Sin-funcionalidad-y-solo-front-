"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[610],{2610:(Vn,L,d)=>{d.r(L),d.d(L,{PanelModule:()=>Jn});var _=d(6895),x=d(9299),e=d(4650),O=d(4004),N=d(7579),ie=d(6063);class oe extends N.x{constructor(a=1/0,t=1/0,i=ie.l){super(),this._bufferSize=a,this._windowTime=t,this._timestampProvider=i,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,a),this._windowTime=Math.max(1,t)}next(a){const{isStopped:t,_buffer:i,_infiniteTimeWindow:o,_timestampProvider:r,_windowTime:l}=this;t||(i.push(a),!o&&i.push(r.now()+l)),this._trimBuffer(),super.next(a)}_subscribe(a){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(a),{_infiniteTimeWindow:i,_buffer:o}=this,r=o.slice();for(let l=0;l<r.length&&!a.closed;l+=i?1:2)a.next(r[l]);return this._checkFinalizedStatuses(a),t}_trimBuffer(){const{_bufferSize:a,_timestampProvider:t,_buffer:i,_infiniteTimeWindow:o}=this,r=(o?1:2)*a;if(a<1/0&&r<i.length&&i.splice(0,i.length-r),!o){const l=t.now();let c=0;for(let m=1;m<i.length&&i[m]<=l;m+=2)c=m;c&&i.splice(0,c+1)}}}var ae=d(3099),g=d(2289),h=d(529);let E=(()=>{class n{constructor(t){this.http=t,this.baseUrl="http://localhost:8080/public"}getClients(){return this.http.get(`${this.baseUrl}/clients`)}getClient(t){return this.http.get(`${this.baseUrl}/clients/${t}`)}getDistribudors(){return this.http.get(`${this.baseUrl}/partners`)}getDistribudor(t){return this.http.get(`${this.baseUrl}/partners/${t}`)}toggleClienteActive(t,i){const o={headers:new h.WM({"Content-Type":"application/merge-patch+json"})};return this.http.patch(t,i,o)}updateCliente(t,i){const o=`${this.baseUrl}/api/clients/${t}`,r={headers:new h.WM({"Content-Type":"application/merge-patch+json"})};return this.http.patch(o,i,r)}getContractData(t){return this.http.get(`http://localhost:8080/public/getContract/${t}`)}uploadFile(t,i){const o=new FormData;return o.append("contract",i),this.http.post(`http://localhost:8080/public/uploadContract/${t}`,o)}updateDistribuidor(t,i){return this.http.patch(`http://localhost:8080/public/api/partners/${t}`,i,{headers:{"Content-Type":"application/merge-patch+json"},withCredentials:!0})}createPartnerCode(t,i){return this.http.post("http://localhost:8080/public/partnerCode",{code:t,partner:`/public/api/partners/${i}`})}updatePartnerCode(t,i){return this.http.patch(`http://localhost:8080/public/partnerCode/${t}`,{code:i})}deletePartnerCode(t){return this.http.delete(`http://localhost:8080/public/partnerCode/${t}`)}uploadContract(t,i){const o=new FormData;return o.append("contract",i),this.http.post(`http://localhost:8080/public/uploadContract/${t}`,o,{withCredentials:!0})}createClient(t){return this.http.post("http://localhost:8080/public/clients",t)}createClientVersion(t,i){const o={joinDate:(new Date).toLocaleDateString("en-GB"),client:`/public/api/clients/${t}`,version:i};return this.http.post("http://localhost:8080/public/clientVersion",o)}updateClient(t,i){return this.http.patch(`http://localhost:8080/public/clients/${t}`,{clientVersions:[`/public/api/client_versions/${i}`]})}createDistribuidor(t){return this.http.post("http://localhost:8080/public/partners",t)}createPartnerCodeNuevoDistribuidor(t){return this.http.post("http://localhost:8080/public/partnerCode",t)}createPartnerEmail(t){return this.http.post("http://localhost:8080/public/partnerEmail",t)}createUser(t){return this.http.post("http://localhost:8080/public/user",t)}createClientNuevoDistribuidor(t){return this.http.post("http://localhost:8080/public/clients",t)}createClientVersionNuevoDistribuidor(t){return this.http.post("http://localhost:8080/public/clientVersion",t)}updateClienteNuevoDistribuidor(t,i){return this.http.patch(`http://localhost:8080/public/clients/${i}`,t)}updateCodigoDistribuidor(t,i){return this.http.patch(`http://localhost:8080/public/partnerCode/${i}`,t)}updateDistribuidorNuevoDistribuidor(t,i){return this.http.patch(`http://localhost:8080/public/partners/${i}`,t)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var j=d(7803),v=d(4859),P=d(7392),H=d(6338),k=d(4850),Y=d(3267),le=d(3683),s=d(4006),u=d(5412);let J=(()=>{class n{constructor(){this.firstNameAndLastnamePattern="([a-zA-Z]+) ([a-zA-Z]+)",this.emailPattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{2,4}$",this.codigoDistribuidorPattern="^[a-zA-Z0-9]+$",this.telefonoPattern="^[0-9]{9,12}$",this.dniPattern="^[0-9]{8}[A-Z]|[XYZ][0-9]{7}[A-Z]$"}isValidField(t,i){return t.controls[i].errors&&t.controls[i].touched}isFieldOneEqualFieldTwo(t,i){return o=>{const r=o.get(t)?.value,l=o.get(i)?.value;return r!==l?(o.get(i)?.setErrors({notEqual:!0}),{notEqual:!0}):(o.get(i)?.setErrors(null),null)}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var f=d(9549),M=d(4144);function se(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre de la empresa es obligatorio "),e.qZA())}function ce(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," El NIF es obligatorio "),e.qZA())}let G=(()=>{class n{constructor(t,i,o,r,l,c){this.fb=t,this.validatorsService=i,this.breakpointObserver=o,this.http=r,this.data=l,this.dialogRef=c,this.nombreEmpresa="",this.nif="",this.myForm=this.fb.group({name:["",[s.kI.required],[]],nif:[,[s.kI.required],[]]})}ngOnInit(){this.myForm=this.fb.group({name:[this.data.name,[s.kI.required]],nif:[this.data.nif,[s.kI.required]]})}close(){this.nombreEmpresa="",this.nif=""}isValidField(t){return this.validatorsService.isValidField(this.myForm,t)}getFieldError(t){if(!this.myForm.controls[t])return null;const i=this.myForm.controls[t].errors||{};for(const o of Object.keys(i))switch(o){case"required":return"Este campo es obligatorio";case"minlength":return`M\xednimo ${i.minlength.requiredLength} caracteres.`}return null}onSave(){this.myForm.valid&&this.dialogRef.close({id:this.data.id,name:this.myForm.value.name,nif:this.myForm.value.nif})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(J),e.Y36(g.Yg),e.Y36(h.eN),e.Y36(u.WI),e.Y36(u.so))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-editar-empresa-modal"]],decls:30,vars:3,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close",""],["autocomplete","off",1,"form-container",3,"formGroup","ngSubmit"],[1,"col-sm-3"],[1,"red-asterisk"],["appearance","outline",1,"field"],["matInput","","formControlName","name","placeholder",""],[4,"ngIf"],[1,"row","mb-3"],[1,"col-sm-9"],["matInput","","formControlName","nif","placeholder",""],["color","basic","mat-flat-button","","matDialogClose","","mat-button","",1,"cancel"],["color","primary","mat-flat-button","","mat-button","","cdkFocusInitial","",1,"green",3,"click"]],template:function(t,i){1&t&&(e.TgZ(0,"h2",0),e._uU(1,"Editar empresa "),e.TgZ(2,"button",1)(3,"mat-icon"),e._uU(4,"close"),e.qZA()()(),e._UZ(5,"mat-divider"),e.TgZ(6,"mat-dialog-content",2),e.NdJ("ngSubmit",function(){return i.onSave()}),e.TgZ(7,"div",3)(8,"mat-label")(9,"span",4),e._uU(10,"*"),e.qZA(),e._uU(11," Nombre empresa"),e.qZA()(),e.TgZ(12,"mat-form-field",5),e._UZ(13,"input",6),e.YNc(14,se,2,0,"mat-error",7),e.qZA(),e.TgZ(15,"div",8)(16,"div",3)(17,"mat-label")(18,"span",4),e._uU(19,"*"),e.qZA(),e._uU(20," NIF"),e.qZA()(),e.TgZ(21,"div",9)(22,"mat-form-field",5),e._UZ(23,"input",10),e.YNc(24,ce,2,0,"mat-error",7),e.qZA()()(),e.TgZ(25,"mat-dialog-actions")(26,"button",11),e._uU(27,"Cerrar"),e.qZA(),e.TgZ(28,"button",12),e.NdJ("click",function(){return i.onSave()}),e._uU(29,"Guardar"),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("formGroup",i.myForm),e.xp6(8),e.Q6J("ngIf",i.isValidField("name")),e.xp6(10),e.Q6J("ngIf",i.isValidField("nif")))},dependencies:[_.O5,v.lW,v.RK,u.ZT,u.uh,u.xY,u.H8,f.KE,f.hX,f.TO,P.Hw,M.Nt,k.d,s.Fj,s.JJ,s.JL,s.sg,s.u],styles:["button[_ngcontent-%COMP%]{float:right}button.cancel[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#000}mat-dialog-actions[_ngcontent-%COMP%]{float:right}.mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.red-asterisk[_ngcontent-%COMP%]{color:red}.mat-divider[_ngcontent-%COMP%]{margin-bottom:1rem}.mat-form-field[_ngcontent-%COMP%]{width:100%}button[mat-dialog-close][_ngcontent-%COMP%]{color:gray}button.cancel[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.field[_ngcontent-%COMP%]{width:100%!important;margin-top:10px;margin-bottom:10px}"]}),n})();var w=d(7974),C=d(7155),de=d(4128);function K(n,a,t,i,o,r,l){try{var c=n[r](l),m=c.value}catch(p){return void t(p)}c.done?a(m):Promise.resolve(m).then(i,o)}function F(n){return function(){var a=this,t=arguments;return new Promise(function(i,o){var r=n.apply(a,t);function l(m){K(r,i,o,l,c,"next",m)}function c(m){K(r,i,o,l,c,"throw",m)}l(void 0)})}}var S=d(9521),Q=d(3238),T=d(7331),R=d(4385),z=d(6709);const me=["fileInput"];let pe=(()=>{class n{constructor(){this.accept="",this.fileSelected=new e.vpe}onFileInputChange(t){const i=t.target.files?.[0];i&&this.fileSelected.emit(i)}onFileDrop(t){t.preventDefault(),t.stopPropagation(),this.fileInput.nativeElement.parentElement.classList.remove("drag-over");const i=t.dataTransfer?.files?.[0];i&&this.fileSelected.emit(i)}onDragOver(t){t.preventDefault(),t.stopPropagation(),this.fileInput.nativeElement.parentElement.classList.add("drag-over")}onDragLeave(t){t.preventDefault(),t.stopPropagation(),this.fileInput.nativeElement.parentElement.classList.remove("drag-over")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-custom-file-input"]],viewQuery:function(t,i){if(1&t&&e.Gf(me,5),2&t){let o;e.iGM(o=e.CRH())&&(i.fileInput=o.first)}},inputs:{accept:"accept"},outputs:{fileSelected:"fileSelected"},decls:7,vars:1,consts:[[1,"field",3,"drop","dragover","dragleave"],["type","file","hidden","",3,"accept","change"],["fileInput",""],[1,"file-input-text",3,"click"],[1,"fa-solid","fa-upload"]],template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",0),e.NdJ("drop",function(l){return i.onFileDrop(l)})("dragover",function(l){return i.onDragOver(l)})("dragleave",function(l){return i.onDragLeave(l)}),e.TgZ(1,"input",1,2),e.NdJ("change",function(l){return i.onFileInputChange(l)}),e.qZA(),e.TgZ(3,"div",3),e.NdJ("click",function(){e.CHM(o);const l=e.MAs(2);return e.KtG(l.click())}),e._UZ(4,"i",4)(5,"br"),e._uU(6," Arrastra el adjunto o haz click aqu\xed. (M\xe1x. 4MB) "),e.qZA()()}2&t&&(e.xp6(1),e.Q6J("accept",i.accept))},styles:[".file-input-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;border:2px dotted rgba(0,0,0,.0823529412);padding:0;text-align:center;cursor:pointer;width:99%;height:150px}"]}),n})();function ue(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip-row",29),e.NdJ("removed",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.remove(r))})("edited",function(o){const l=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.edit(l,o))}),e._uU(1),e.TgZ(2,"button",30)(3,"mat-icon"),e._uU(4,"cancel"),e.qZA()()()}if(2&n){const t=a.$implicit;e.Q6J("editable",!0)("aria-description","press enter to edit "+t.code),e.xp6(1),e.hij(" ",t.code," "),e.xp6(1),e.uIk("aria-label","remove "+t.code)}}function ge(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe estar entre 0 y 100 "),e.qZA())}function _e(n,a){if(1&n&&(e.TgZ(0,"mat-option",31),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t.name),e.xp6(1),e.hij(" ",t.name," ")}}function he(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe elegir un valor "),e.qZA())}function fe(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe elegir un valor "),e.qZA())}const be=function(){return{}};let Ce=(()=>{class n{constructor(t,i,o,r,l,c){this.fb=t,this.validatorsService=i,this.breakpointObserver=o,this.http=r,this.backendService=l,this.data=c,this.selectedFile=null,this.isSmallScreen=!1,this.separatorKeysCodes=[S.K5,S.OC],this.deletedCodigos=[],this.editedCodigos=[],this.myForm=this.fb.group({name:["",[s.kI.required,s.kI.minLength(3)]],codes:this.fb.array([]),margin:["",[s.kI.required,s.kI.min(0),s.kI.max(100)]],active:[""],type:[]}),this.codes=this.data.distribuidor.codes,this.newCodes=[],this.distribuidor=c.distribuidor,this.tableComponent=c.tableComponent}onFileSelected(t){this.selectedFile=t}add(t){const i=(t.value||"").trim();if(i){const o={id:0,code:i};this.codes.push(o),this.newCodes.push(o)}t.input&&(t.input.value="")}remove(t){const i=this.codes.indexOf(t);if(i>=0){this.codes.splice(i,1);const o=this.newCodes.findIndex(r=>r.code===t.code);o>=0&&this.newCodes.splice(o,1),this.deletedCodigos.push(t)}}removeDeletedCodigos(){this.codes=this.codes.filter(t=>!this.deletedCodigos.includes(t))}deleteRemovedCodigos(){var t=this;return F(function*(){for(const i of t.deletedCodigos)yield t.http.delete(`http://localhost:8080/public/partnerCode/${i.id}`).toPromise()})()}edit(t,i){const o=i.value.trim();if(!o)return void this.remove(t);const r=this.codes.indexOf(t);r>=0&&(this.codes[r].code=o,this.editedCodigos.push(this.codes[r]))}clear(){this.myForm.get("name").setValue(null)}isValidField(t){return this.validatorsService.isValidField(this.myForm,t)}isValidFieldInArray(t,i){return t.controls[i].errors&&t.controls[i].touched}getFieldError(t){if(!this.myForm.controls[t])return null;const i=this.myForm.controls[t].errors||{};for(const o of Object.keys(i))switch(o){case"required":return"Este campo es requerido";case"minlength":return`M\xednimo ${i.minlength.requiredLength} caracters.`}return null}responseToDistribuidorElement(t){return{id:t.id,name:t.name,active:t.active,companies:t.companies,margin:t.margin,nif:t.nif,type:t.type,phone:t.phone,contract:t.contract,codes:[],emails:[]}}onSubmit(){var t=this;return F(function*(){const i={...t.data.distribuidor,...t.myForm.value},o={name:i.name,margin:Number(i.margin),active:i.active,type:i.type};t.backendService.updateDistribuidor(i.id,o).subscribe(r=>{console.log("Distribuidor updated successfully");const l={id:r.id,name:i.name,margin:Number(i.margin),active:i.active,type:i.type,companies:i.companies,nif:i.nif,phone:i.phone,codes:t.data.distribuidor.codes,emails:t.data.distribuidor.emails,contract:i.contract};t.tableComponent.updateDistribuidor(l)},r=>{console.log("Error updating Distribuidor")}),t.newCodes.forEach(r=>{t.backendService.createPartnerCode(r.code,i.id).subscribe(l=>{console.log(`Partner code ${l.id} created successfully`)},l=>{console.log("Error creating partner code")})}),t.editedCodigos.forEach(r=>{t.backendService.updatePartnerCode(r.id,r.code).subscribe(()=>{console.log(`Partner code ${r.id} updated successfully`)},l=>{console.log(`Error updating partner code ${r.id}`)})}),t.deletedCodigos.forEach(r=>{t.backendService.deletePartnerCode(r.id).subscribe(()=>{console.log(`Partner code ${r.id} deleted successfully`)},l=>{console.log(`Error deleting partner code ${r.id}`)})}),t.selectedFile&&t.backendService.uploadContract(i.id,t.selectedFile).subscribe(()=>{console.log("Contract uploaded successfully")},r=>{console.log("Error uploading contract"),console.log(r)}),console.log("Soy el async")})()}updateDistribuidor(t,i){this.backendService.updateDistribuidor(t,i).subscribe(o=>{console.log("Distribuidor updated successfully");const r={id:o.id,name:i.nombre,margin:Number(i.margin),active:i.active,type:i.type,companies:this.data.distribuidor.companies,nif:this.data.distribuidor.nif,phone:this.data.distribuidor.phone,codes:this.data.distribuidor.codes,emails:this.data.distribuidor.emails,contract:o.contract};this.tableComponent.updateDistribuidor(r)},o=>{console.log("Soy el updateDistribuidor"),console.log("Error updating Distribuidor")})}ngOnInit(){this.breakpointObserver.observe([g.u3.XSmall,g.u3.Small]).subscribe(t=>{this.isSmallScreen=t.matches}),this.data&&this.data.distribuidor&&(this.myForm.patchValue({name:this.data.distribuidor.name,margin:this.data.distribuidor.margin,active:this.data.distribuidor.active,type:this.data.distribuidor.type}),this.myForm.setControl("codes",this.fb.array(this.data.distribuidor.codes.map(t=>this.fb.group({id:[t.id],code:[t.code]})))))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(J),e.Y36(g.Yg),e.Y36(h.eN),e.Y36(E),e.Y36(u.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-asignar-distribuidor-modal"]],decls:72,vars:11,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close",""],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"field"],[1,"col-sm-3"],[1,"red-asterisk"],[2,"height","fit-content"],["appearance","outline",1,"example-chip-list","field"],["aria-label","Enter promo codes"],["chipGrid",""],[3,"editable","aria-description","removed","edited",4,"ngFor","ngForOf"],[3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],[1,"col-sm-3","col-form-label"],[1,"col-sm-9"],["color","basic","id","flexCheckDefault","formControlName","active"],["appearance","outline",2,"width","100%"],["matInput","","formControlName","margin","placeholder",""],[4,"ngIf"],["appearance","outline",1,"field"],["formControlName","name","placeholder","Seleccione un valor"],[3,"value",4,"ngFor","ngForOf"],["matSuffix","",3,"click"],["formControlName","type","placeholder","Seleccione un valor"],["value","Partner Supra"],["value","Partner"],["value","Referenciador"],[3,"accept","fileSelected"],["color","basic","mat-flat-button","","matDialogClose","","mat-button","",1,"cancel"],["color","primary","mat-flat-button","","mat-button","","cdkFocusInitial","",1,"green",3,"mat-dialog-close","click"],[3,"editable","aria-description","removed","edited"],["matChipRemove",""],[3,"value"]],template:function(t,i){if(1&t&&(e.TgZ(0,"h2",0),e._uU(1,"Asignar distribuidor "),e.TgZ(2,"button",1)(3,"mat-icon"),e._uU(4,"close"),e.qZA()()(),e._UZ(5,"mat-divider"),e.TgZ(6,"mat-dialog-content",2),e.NdJ("ngSubmit",function(){return i.onSubmit()}),e.TgZ(7,"div",3)(8,"div",4)(9,"mat-label")(10,"span",5),e._uU(11,"*"),e.qZA(),e._uU(12," Promo"),e.qZA()(),e.TgZ(13,"div",6)(14,"mat-form-field",7)(15,"mat-chip-grid",8,9),e.YNc(17,ue,5,4,"mat-chip-row",10),e.TgZ(18,"input",11),e.NdJ("matChipInputTokenEnd",function(r){return i.add(r)}),e.qZA()()()()(),e.TgZ(19,"div"),e._UZ(20,"label",12),e.TgZ(21,"div",13)(22,"mat-checkbox",14)(23,"mat-label"),e._uU(24,"Activo"),e.qZA()()()(),e.TgZ(25,"div",3)(26,"div",4)(27,"mat-label")(28,"span",5),e._uU(29,"*"),e.qZA(),e._uU(30," Margen"),e.qZA()(),e.TgZ(31,"div",13)(32,"mat-form-field",15),e._UZ(33,"input",16),e.YNc(34,ge,2,0,"mat-error",17),e.qZA()()(),e.TgZ(35,"div")(36,"div",4)(37,"mat-label")(38,"span",5),e._uU(39,"*"),e.qZA(),e._uU(40," Empresa asociada al c\xf3digo"),e.qZA()(),e.TgZ(41,"div",13)(42,"mat-form-field",18)(43,"mat-select",19),e.YNc(44,_e,2,2,"mat-option",20),e.qZA(),e.TgZ(45,"mat-icon",21),e.NdJ("click",function(){return i.clear()}),e._uU(46,"cancel"),e.qZA(),e.YNc(47,he,2,0,"mat-error",17),e.qZA()()(),e.TgZ(48,"div")(49,"div",4)(50,"mat-label")(51,"span",5),e._uU(52,"*"),e.qZA(),e._uU(53," Tipo de distribuidor"),e.qZA()(),e.TgZ(54,"div",13)(55,"mat-form-field",18)(56,"mat-select",22)(57,"mat-option",23),e._uU(58,"Partner Supra"),e.qZA(),e.TgZ(59,"mat-option",24),e._uU(60,"Partner"),e.qZA(),e.TgZ(61,"mat-option",25),e._uU(62,"Referenciador"),e.qZA()(),e.TgZ(63,"mat-icon",21),e.NdJ("click",function(){return i.clear()}),e._uU(64,"cancel"),e.qZA(),e.YNc(65,fe,2,0,"mat-error",17),e.qZA()()(),e.TgZ(66,"app-custom-file-input",26),e.NdJ("fileSelected",function(r){return i.onFileSelected(r)}),e.qZA(),e.TgZ(67,"mat-dialog-actions")(68,"button",27),e._uU(69,"Cerrar"),e.qZA(),e.TgZ(70,"button",28),e.NdJ("click",function(){return i.onSubmit()}),e._uU(71,"Guardar"),e.qZA()()()),2&t){const o=e.MAs(16);e.xp6(6),e.Q6J("formGroup",i.myForm),e.xp6(11),e.Q6J("ngForOf",i.codes),e.xp6(1),e.Q6J("matChipInputFor",o)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes),e.xp6(16),e.Q6J("ngIf",i.isValidField("margin")),e.xp6(10),e.Q6J("ngForOf",i.data.allDistribuidors),e.xp6(3),e.Q6J("ngIf",i.isValidField("name")),e.xp6(18),e.Q6J("ngIf",i.isValidField("type")),e.xp6(1),e.Q6J("accept",".pdf"),e.xp6(4),e.Q6J("mat-dialog-close",e.DdM(10,be))}},dependencies:[_.sg,_.O5,Q.ey,v.lW,v.RK,T.RA,T.oH,T.qH,T.z3,u.ZT,u.uh,u.xY,u.H8,f.KE,f.hX,f.TO,f.R9,P.Hw,M.Nt,k.d,R.gD,z.oG,s.Fj,s.JJ,s.JL,s.sg,s.u,pe],styles:[".red-asterisk[_ngcontent-%COMP%]{color:red}.chip-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin:-4px}.chip-row[_ngcontent-%COMP%]   mat-chip[_ngcontent-%COMP%]{margin:4px}.mat-divider[_ngcontent-%COMP%]{margin-bottom:1rem}.mat-form-field[_ngcontent-%COMP%]{width:100%}button[mat-dialog-close][_ngcontent-%COMP%]{color:gray;float:right}mat-dialog-actions[_ngcontent-%COMP%]{float:right}button.cancel[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#000}button.cancel[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.mat-chip[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:4px;display:inline-block;margin-right:4px;margin-bottom:4px;padding:4px 12px;background-color:transparent}.mat-chip-text[_ngcontent-%COMP%]{color:#000}.field[_ngcontent-%COMP%]{width:100%!important;margin-top:10px;margin-bottom:10px}"]}),n})();var ve=d(8505),Ze=d(262),Te=d(2843);const xe=["class","ts"];function ye(n,a){if(1&n&&(e.TgZ(0,"mat-option",10),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.Q6J("value",t.clientesCount),e.xp6(1),e.Oqu(t.clientesCount)}}function Ae(n,a){1&n&&(e.TgZ(0,"mat-option",10),e._uU(1,"0"),e.qZA()),2&n&&e.Q6J("value",0)}function Ue(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-chip-row",19),e.NdJ("removed",function(){const r=e.CHM(t).$implicit,l=e.oxw();return e.KtG(l.remove(r))})("edited",function(o){const l=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.edit(l,o))}),e._uU(1),e.TgZ(2,"button",20)(3,"mat-icon"),e._uU(4,"cancel"),e.qZA()()()}if(2&n){const t=a.$implicit;e.Q6J("editable",!0)("aria-description","press enter to edit "+t.email),e.xp6(1),e.hij(" ",t.email," "),e.xp6(1),e.uIk("aria-label","remove "+t.email)}}const De=function(){return{}};let Pe=(()=>{class n{constructor(t,i,o,r){this.fb=t,this.http=i,this.dialogRef=o,this.data=r,this.deletedEmails=[],this.editedEmails=[],this.separatorKeysCodes=[S.K5,S.OC],this.dataUpdated=new e.vpe,this.myForm=this.fb.group({partnerName:["",[s.kI.required,s.kI.minLength(3)]],code:[],emails:[],numero:[]}),this.emails=this.data.distribuidor.emails,this.emailsCodigo=[],this.newEmails=[],this.codigosActivos=[]}ngOnInit(){this.fetchCodigosEmail().subscribe(t=>{this.emailsCodigo=t},t=>{console.error(t)}),this.fetchCodigosActivos(),this.myForm.patchValue({code:this.data.codigoDistribuidor.code}),this.fetchClientesCount(this.data.codigoDistribuidor.id).subscribe(t=>{this.clientesCount=t,this.myForm.patchValue({numero:t})},t=>{console.error(t)})}fetchCodigosEmail(){return this.http.get(`http://localhost:8080/public/partnerCodeEmails/${this.data.codigoDistribuidor.id}`).pipe((0,ve.b)(i=>{this.codigosActivos=i}),(0,Ze.K)(i=>(console.error(i),console.log("Error fetching active codigos"),(0,Te._)(i))))}fetchClientesCount(t){return this.http.get(`http://localhost:8080/public/clientsCount/${t}`)}fetchCodigosActivos(){this.http.get("http://localhost:8080/public/getActiveCodes").subscribe(i=>{this.codigosActivos=i},i=>{console.error(i),console.log("Error fetching active codigos")})}add(t){const i=(t.value||"").trim();if(i){const o={id:0,email:i};this.emailsCodigo.push(o),this.newEmails.push(o)}t.input&&(t.input.value="")}remove(t){this.emailsCodigo=this.emailsCodigo.filter(i=>i!==t),this.deletedEmails.push(t)}removeDeletedCodigos(){this.emails=this.emails.filter(t=>!this.deletedEmails.includes(t))}deleteRemovedCodigos(){var t=this;return F(function*(){for(const i of t.deletedEmails)yield t.http.delete(`http://localhost:8080/public/partnerCode/${i.id}`).toPromise()})()}edit(t,i){const o=i.value.trim();o?this.emailsCodigo=this.emailsCodigo.map(r=>(r===t&&(r.email=o,this.editedEmails.push(r)),r)):this.remove(t)}onSubmit(){var t=this;return F(function*(){const i={...t.data.distribuidor,...t.myForm.value};Number(i.margin),t.newEmails.forEach(r=>{t.http.post("http://localhost:8080/public/partnerEmail",{partnerCodes:[`/public/api/partner_codes/${t.data.codigoDistribuidor.id}`],email:r.email}).subscribe(l=>{console.log(`EmailDistribuidor ${l.id} created successfully`)},l=>{console.log("Error creating new CodigoDistribuidor")})}),t.editedEmails.forEach(r=>{console.log(`Updating EmailDistribuidor ${r.id}`),t.http.patch(`http://localhost:8080/public/partnerEmail/${r.id}`,{email:r.email}).subscribe(()=>{console.log(`EmailDistribuidor ${r.id} updated successfully`)},l=>{console.log(`Error updating CodigoDistribuidor ${r.id}`)})}),t.deletedEmails.forEach(r=>{console.log(`Deleting EmailDistribuidor ${r.id}`),t.http.delete(`http://localhost:8080/public/partnerEmail/${r.id}`).subscribe(()=>{console.log(`EmailDistribuidor ${r.id} deleted successfully`)},l=>{console.log(`Error deleting CodigoDistribuidor ${r.id}`)})}),t.dataUpdated.emit()})()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(h.eN),e.Y36(u.so),e.Y36(u.WI))},n.\u0275cmp=e.Xpm({type:n,selectors:[["editar-codigo-modal",8,"ts"]],outputs:{dataUpdated:"dataUpdated"},attrs:xe,decls:45,vars:11,consts:[["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close",""],["autocomplete","off",1,"form-container",3,"formGroup"],[1,"col-sm-3"],[1,"red-asterisk"],[1,"col-sm-9"],["appearance","outline",1,"field"],["formControlName","numero",3,"ngModel","ngModelChange"],[3,"value",4,"ngIf"],["formControlName","code","placeholder","Seleccione un valor"],[3,"value"],[2,"height","fit-content"],["appearance","outline",1,"example-chip-list","field"],["aria-label","Enter emails"],["chipGrid",""],[3,"editable","aria-description","removed","edited",4,"ngFor","ngForOf"],[3,"matChipInputFor","matChipInputSeparatorKeyCodes","matChipInputTokenEnd"],["color","basic","mat-flat-button","","matDialogClose","","mat-button","",1,"cancel"],["color","primary","mat-flat-button","","mat-button","","cdkFocusInitial","",1,"green",3,"mat-dialog-close","click"],[3,"editable","aria-description","removed","edited"],["matChipRemove",""]],template:function(t,i){if(1&t&&(e.TgZ(0,"h2",0),e._uU(1,"Editar codigo "),e.TgZ(2,"button",1)(3,"mat-icon"),e._uU(4,"close"),e.qZA()()(),e._UZ(5,"mat-divider"),e.TgZ(6,"mat-dialog-content",2)(7,"div")(8,"div",3)(9,"mat-label")(10,"span",4),e._uU(11,"*"),e.qZA(),e._uU(12," N\xba de clientes"),e.qZA()(),e.TgZ(13,"div",5)(14,"mat-form-field",6)(15,"mat-select",7),e.NdJ("ngModelChange",function(r){return i.clientesCount=r}),e.YNc(16,ye,2,2,"mat-option",8),e.YNc(17,Ae,2,1,"mat-option",8),e.qZA()()()(),e.TgZ(18,"div")(19,"div",3)(20,"mat-label")(21,"span",4),e._uU(22,"*"),e.qZA(),e._uU(23," C\xf3digo"),e.qZA()(),e.TgZ(24,"div",5)(25,"mat-form-field",6)(26,"mat-select",9)(27,"mat-option",10),e._uU(28),e.qZA()()()()(),e.TgZ(29,"div",3)(30,"mat-label")(31,"span",4),e._uU(32,"*"),e.qZA(),e._uU(33," Emails de aviso"),e.qZA()(),e.TgZ(34,"div",11)(35,"mat-form-field",12)(36,"mat-chip-grid",13,14),e.YNc(38,Ue,5,4,"mat-chip-row",15),e.TgZ(39,"input",16),e.NdJ("matChipInputTokenEnd",function(r){return i.add(r)}),e.qZA()()()()(),e.TgZ(40,"mat-dialog-actions")(41,"button",17),e._uU(42,"Cerrar"),e.qZA(),e.TgZ(43,"button",18),e.NdJ("click",function(){return i.onSubmit()}),e._uU(44,"Guardar"),e.qZA()()),2&t){const o=e.MAs(37);e.xp6(6),e.Q6J("formGroup",i.myForm),e.xp6(9),e.Q6J("ngModel",i.clientesCount),e.xp6(1),e.Q6J("ngIf",i.clientesCount),e.xp6(1),e.Q6J("ngIf",!i.clientesCount),e.xp6(10),e.Q6J("value",i.data.codigoDistribuidor.code),e.xp6(1),e.Oqu(i.data.codigoDistribuidor.code),e.xp6(10),e.Q6J("ngForOf",i.emailsCodigo),e.xp6(1),e.Q6J("matChipInputFor",o)("matChipInputSeparatorKeyCodes",i.separatorKeysCodes),e.xp6(4),e.Q6J("mat-dialog-close",e.DdM(10,De))}},dependencies:[_.sg,_.O5,Q.ey,v.lW,v.RK,T.RA,T.oH,T.qH,T.z3,u.ZT,u.uh,u.xY,u.H8,f.KE,f.hX,P.Hw,k.d,R.gD,s.JJ,s.JL,s.sg,s.u],styles:["button[_ngcontent-%COMP%]{float:right}button.cancel[_ngcontent-%COMP%]{background-color:#f5f5f5;color:#000}mat-dialog-actions[_ngcontent-%COMP%]{float:right}.mat-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.red-asterisk[_ngcontent-%COMP%]{color:red}.mat-divider[_ngcontent-%COMP%]{margin-bottom:1rem}.mat-form-field[_ngcontent-%COMP%]{width:100%}button[mat-dialog-close][_ngcontent-%COMP%]{color:gray}button.cancel[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}.field[_ngcontent-%COMP%]{width:100%!important;margin-top:10px;margin-bottom:10px}"]}),n})(),qe=(()=>{class n{constructor(t){this.http=t,this.baseUrl="http://localhost:8080/public"}getClientesByDistribuidor(t,i){return this.http.get(`${this.baseUrl}/partnerClients/${t}/${i}`)}getClientes(t=1,i=50){return this.http.get(`${this.baseUrl}/api/clients?page=${t}&itemsPerPage=${i}`)}getCodigoDistribuidor(t){return this.http.get(`${this.baseUrl}/api/partner_codes/${t}`)}processCliente(t){const i=this.extractIdFromIri(t.codigo);return{...t,codigo:i}}extractIdFromIri(t){const i=t.split("/");return parseInt(i[i.length-1],10)}getCodigoDistribuidorsByCliente(t){return this.http.get(`${this.baseUrl}/clientCode/${t}`)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Ne=(()=>{class n{constructor(t){this.http=t,this.baseUrl="http://localhost:8080/public"}getDistribuidores(t=1,i=50){return this.http.get(`${this.baseUrl}/api/partners?page=${t}&itemsPerPage=${i}`)}getCodigoDistribuidorsByDistribuidor(t){return this.http.get(`${this.baseUrl}/partnerCodesUsingId/${t}`)}getCodigosDistribuidorsByDistribuidor(t){let i=new h.LE;return t.forEach(o=>{i=i.append("ids[]",o.toString())}),this.http.get(`${this.baseUrl}/partnerCodesUsingIds`,{params:i})}getCodigoDistribuidor(t){return this.http.get(`${this.baseUrl}/api/partner_codes/${t}`)}getEmailDistribuidorsByDistribuidor(t){return this.http.get(`${this.baseUrl}/partnerEmailsUsingId/${t}`)}getDistribuidoresWithCodesAndEmails(t=1,i=50){return this.http.get(`${this.baseUrl}/api/partners-with-codes-and-emails?page=${t}&itemsPerPage=${i}`)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var U=d(8255),X=d(6308);let Ee=(()=>{class n{constructor(){this.fileSelected=new e.vpe}ngOnInit(){}onFileChange(t){t.target.files&&t.target.files.length>0&&this.fileSelected.emit(t.target.files[0])}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-table-file-input"]],outputs:{fileSelected:"fileSelected"},decls:4,vars:0,consts:[["type","button",3,"click"],[1,"fa-solid","fa-upload",2,"color","#deddda"],["type","file","accept",".pdf",2,"display","none",3,"change"],["fileInput",""]],template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"button",0),e.NdJ("click",function(){e.CHM(o);const l=e.MAs(3);return e.KtG(l.click())}),e._UZ(1,"i",1),e.TgZ(2,"input",2,3),e.NdJ("change",function(l){return i.onFileChange(l)}),e.qZA()()}},styles:["button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;outline:none;padding:0}i.fa-solid.fa-upload[_ngcontent-%COMP%]{font-size:24px}"]}),n})();function ke(n,a){1&n&&e._UZ(0,"mat-header-cell")}function Me(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",13),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw().$implicit,c=e.oxw(2);return e.KtG(c.openEditCodigoDistribuidorModal(r,l))}),e._uU(2),e.qZA(),e.BQk()}if(2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",t.code," ")}}function we(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"div",14),e._uU(2),e.qZA(),e.BQk()),2&n){const t=a.$implicit;e.xp6(2),e.Oqu(t.email)}}function Fe(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",15),e.BQk())}function Se(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",16),e.BQk())}function Ie(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-cell")(1,"div",7)(2,"div")(3,"strong",8),e._uU(4,"Nombre:"),e.qZA(),e.TgZ(5,"span",9),e._uU(6),e.qZA()(),e.TgZ(7,"div")(8,"strong"),e._uU(9,"C\xf3digo:"),e.qZA(),e.YNc(10,Me,3,1,"ng-container",10),e.qZA(),e.TgZ(11,"div")(12,"strong"),e._uU(13,"Margen:"),e.qZA(),e._uU(14),e.qZA(),e.TgZ(15,"div")(16,"strong"),e._uU(17,"Empresas:"),e.qZA(),e._uU(18),e.qZA(),e.TgZ(19,"div")(20,"strong"),e._uU(21,"Email de Aviso:"),e.qZA(),e.YNc(22,we,3,1,"ng-container",10),e.qZA(),e.TgZ(23,"div")(24,"strong"),e._uU(25,"Activo:"),e.qZA(),e.YNc(26,Fe,2,0,"ng-container",0),e.YNc(27,Se,2,0,"ng-container",0),e.qZA(),e.TgZ(28,"div")(29,"strong"),e._uU(30,"Acciones:"),e.qZA(),e.TgZ(31,"button",11),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(2);return e.KtG(l.openAsignarDistribuidorModal(r))}),e._UZ(32,"i",12),e.qZA()()()()}if(2&n){const t=a.$implicit;e.xp6(6),e.Oqu(t.name),e.xp6(4),e.Q6J("ngForOf",t.codes),e.xp6(4),e.hij(" ",t.margin," % "),e.xp6(4),e.hij(" ",t.companies," "),e.xp6(4),e.Q6J("ngForOf",t.emails),e.xp6(4),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active)}}function Oe(n,a){1&n&&e._UZ(0,"mat-header-row")}function Ye(n,a){1&n&&e._UZ(0,"mat-row")}const I=function(){return["combined"]};function Je(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"table",1),e.ynx(2,2),e.YNc(3,ke,1,0,"mat-header-cell",3),e.YNc(4,Ie,33,7,"mat-cell",4),e.BQk(),e.YNc(5,Oe,1,0,"mat-header-row",5),e.YNc(6,Ye,1,0,"mat-row",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.tableData),e.xp6(4),e.Q6J("matHeaderRowDef",e.DdM(3,I)),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(4,I))}}function Qe(n,a){1&n&&e._UZ(0,"mat-header-cell")}function Re(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",18),e.BQk())}function $e(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",19),e.BQk())}const W=function(n){return{"blue-text":n}};function Ve(n,a){if(1&n&&(e.TgZ(0,"mat-cell")(1,"div",7)(2,"div")(3,"strong",8),e._uU(4,"Nombre:"),e.qZA(),e._uU(5),e.qZA(),e.TgZ(6,"div")(7,"strong"),e._uU(8,"Versi\xf3n:"),e.qZA(),e.TgZ(9,"span",17),e._uU(10),e.qZA()(),e.TgZ(11,"div")(12,"strong"),e._uU(13,"Activo:"),e.qZA(),e.YNc(14,Re,2,0,"ng-container",0),e.YNc(15,$e,2,0,"ng-container",0),e.qZA(),e.TgZ(16,"div")(17,"strong"),e._uU(18,"Fecha creaci\xf3n:"),e.qZA(),e._uU(19),e.qZA(),e.TgZ(20,"div")(21,"strong"),e._uU(22,"C\xf3digo promocional:"),e.qZA(),e._uU(23),e.qZA(),e.TgZ(24,"div")(25,"strong"),e._uU(26,"Grupo de facturaci\xf3n:"),e.qZA(),e._uU(27),e.qZA(),e.TgZ(28,"div")(29,"strong"),e._uU(30,"Empleados activos:"),e.qZA(),e._uU(31),e.qZA()()()),2&n){const t=a.$implicit;e.xp6(5),e.hij(" ",t.name," "),e.xp6(4),e.Q6J("ngClass",e.VKq(9,W,"pro"===t.currentVersion.toLowerCase())),e.xp6(1),e.Oqu(t.currentVersion),e.xp6(4),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(4),e.hij(" ",t.joinDate||"-"," "),e.xp6(4),e.hij(" ",t.code.code," "),e.xp6(4),e.hij(" ",t.billing||"-"," "),e.xp6(4),e.hij(" ",t.employees," ")}}function Be(n,a){1&n&&e._UZ(0,"mat-header-row")}function Le(n,a){1&n&&e._UZ(0,"mat-row")}function je(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"table",1),e.ynx(2,2),e.YNc(3,Qe,1,0,"mat-header-cell",3),e.YNc(4,Ve,32,11,"mat-cell",4),e.BQk(),e.YNc(5,Be,1,0,"mat-header-row",5),e.YNc(6,Le,1,0,"mat-row",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.tableData),e.xp6(4),e.Q6J("matHeaderRowDef",e.DdM(3,I)),e.xp6(1),e.Q6J("matRowDefColumns",e.DdM(4,I))}}function He(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Nombre "),e.qZA())}function Ge(n,a){if(1&n&&(e.TgZ(0,"mat-cell",9),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Ke(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," C\xf3digo "),e.qZA())}function ze(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",32),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw().$implicit,c=e.oxw(3);return e.KtG(c.openEditCodigoDistribuidorModal(r,l))}),e._uU(2),e.qZA(),e.BQk()}if(2&n){const t=a.$implicit;e.xp6(2),e.hij(" ",t.code," ")}}function Xe(n,a){if(1&n&&(e.TgZ(0,"mat-cell")(1,"div"),e.YNc(2,ze,3,1,"ng-container",10),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.Q6J("ngForOf",t.codes)}}function We(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Margen "),e.qZA())}function et(n,a){if(1&n&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.margin," % ")}}function tt(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Empresas "),e.qZA())}function nt(n,a){if(1&n&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.companies," ")}}function it(n,a){1&n&&(e.TgZ(0,"mat-header-cell"),e._uU(1," Acciones "),e.qZA())}function ot(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-table-file-input",35),e.NdJ("fileSelected",function(o){e.CHM(t);const r=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.onFileSelected(o,r))}),e.qZA(),e.BQk()}}function at(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"button",11),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit,r=e.oxw(3);return e.KtG(r.openPdf(o.id))}),e._UZ(1,"i",36),e.qZA()}}function rt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-cell")(1,"div",33),e.YNc(2,ot,2,0,"ng-container",0),e.YNc(3,at,2,0,"button",34),e.TgZ(4,"button",11),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.openAsignarDistribuidorModal(r))}),e._UZ(5,"i",12),e.qZA()()()}if(2&n){const t=a.$implicit;e.xp6(2),e.Q6J("ngIf",!t.contract),e.xp6(1),e.Q6J("ngIf",t.contract)}}function lt(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Email de Aviso "),e.qZA())}function st(n,a){if(1&n&&(e.ynx(0),e._uU(1),e._UZ(2,"br"),e.BQk()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.email,"")}}function ct(n,a){if(1&n&&(e.TgZ(0,"mat-cell"),e.YNc(1,st,3,1,"ng-container",10),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngForOf",t.emails)}}function dt(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Activo "),e.qZA())}function mt(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",37),e.BQk())}function pt(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",38),e.BQk())}function ut(n,a){if(1&n&&(e.TgZ(0,"mat-cell")(1,"div",33),e.YNc(2,mt,2,0,"ng-container",0),e.YNc(3,pt,2,0,"ng-container",0),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active)}}function gt(n,a){1&n&&(e.ynx(0)(1,21),e.TgZ(2,"div",22),e.YNc(3,He,2,0,"mat-header-cell",23),e.qZA(),e.YNc(4,Ge,2,1,"mat-cell",24),e.BQk(),e.ynx(5,25),e.YNc(6,Ke,2,0,"mat-header-cell",23),e.YNc(7,Xe,3,1,"mat-cell",4),e.BQk(),e.ynx(8,26),e.TgZ(9,"div",22),e.YNc(10,We,2,0,"mat-header-cell",23),e.qZA(),e.YNc(11,et,2,1,"mat-cell",4),e.BQk(),e.ynx(12,27),e.YNc(13,tt,2,0,"mat-header-cell",23),e.YNc(14,nt,2,1,"mat-cell",4),e.BQk(),e.ynx(15,28),e.YNc(16,it,2,0,"mat-header-cell",3),e.YNc(17,rt,6,2,"mat-cell",4),e.BQk(),e.ynx(18,29),e.YNc(19,lt,2,0,"mat-header-cell",23),e.YNc(20,ct,2,1,"mat-cell",4),e.BQk(),e.ynx(21,30),e.YNc(22,dt,2,0,"mat-header-cell",23),e.YNc(23,ut,4,2,"mat-cell",4),e.BQk()())}function _t(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Nombre "),e.qZA())}function ht(n,a){if(1&n&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function ft(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Versi\xf3n "),e.qZA())}function bt(n,a){if(1&n&&(e.TgZ(0,"mat-cell")(1,"span",43),e._uU(2),e.qZA()()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngClass",e.VKq(2,W,"pro"===t.currentVersion.toLowerCase())),e.xp6(1),e.hij(" ",t.currentVersion," ")}}function Ct(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Activo "),e.qZA())}function vt(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",37),e.BQk())}function Zt(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",44),e.BQk())}function Tt(n,a){if(1&n&&(e.TgZ(0,"mat-cell")(1,"div",33),e.YNc(2,vt,2,0,"ng-container",0),e.YNc(3,Zt,2,0,"ng-container",0),e.qZA()()),2&n){const t=a.$implicit;e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active)}}function xt(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Fecha creaci\xf3n "),e.qZA())}function yt(n,a){if(1&n&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.joinDate||"-"," ")}}function At(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," C\xf3digo promocional "),e.qZA())}function Ut(n,a){if(1&n&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.code.code," ")}}function Dt(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Grupo de facturaci\xf3n "),e.qZA())}function Pt(n,a){if(1&n&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.billing||"-"," ")}}function qt(n,a){1&n&&(e.TgZ(0,"mat-header-cell",31),e._uU(1," Empleados activos "),e.qZA())}function Nt(n,a){if(1&n&&(e.TgZ(0,"mat-cell"),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.xp6(1),e.hij(" ",t.employees," ")}}function Et(n,a){1&n&&e._UZ(0,"mat-header-cell")}function kt(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",51),e.TgZ(2,"span",50),e._uU(3,"desactivar empresa"),e.qZA(),e.BQk())}function Mt(n,a){1&n&&(e.ynx(0),e._UZ(1,"i",52),e.TgZ(2,"span",50),e._uU(3,"activar empresa"),e.qZA(),e.BQk())}function wt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"mat-cell")(1,"div",33)(2,"button",45),e._UZ(3,"i",46),e.qZA(),e.TgZ(4,"mat-menu",null,47)(6,"button",48),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.openEditarEmpresaModal(r))}),e._UZ(7,"i",49),e.TgZ(8,"span",50),e._uU(9,"editar empresa"),e.qZA()(),e.TgZ(10,"button",48),e.NdJ("click",function(){const r=e.CHM(t).$implicit,l=e.oxw(3);return e.KtG(l.toggleClienteActive(r))}),e.YNc(11,kt,4,0,"ng-container",0),e.YNc(12,Mt,4,0,"ng-container",0),e.qZA()()()()}if(2&n){const t=a.$implicit,i=e.MAs(5);e.xp6(2),e.Q6J("matMenuTriggerFor",i),e.xp6(9),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active)}}function Ft(n,a){1&n&&(e.ynx(0)(1,21),e.YNc(2,_t,2,0,"mat-header-cell",23),e.YNc(3,ht,2,1,"mat-cell",4),e.BQk(),e.ynx(4,39),e.YNc(5,ft,2,0,"mat-header-cell",23),e.YNc(6,bt,3,4,"mat-cell",4),e.BQk(),e.ynx(7,30),e.YNc(8,Ct,2,0,"mat-header-cell",23),e.YNc(9,Tt,4,2,"mat-cell",4),e.BQk(),e.ynx(10,40),e.YNc(11,xt,2,0,"mat-header-cell",23),e.YNc(12,yt,2,1,"mat-cell",4),e.BQk(),e.ynx(13,25),e.YNc(14,At,2,0,"mat-header-cell",23),e.YNc(15,Ut,2,1,"mat-cell",4),e.BQk(),e.ynx(16,41),e.YNc(17,Dt,2,0,"mat-header-cell",23),e.YNc(18,Pt,2,1,"mat-cell",4),e.BQk(),e.ynx(19,42),e.YNc(20,qt,2,0,"mat-header-cell",23),e.YNc(21,Nt,2,1,"mat-cell",4),e.BQk(),e.ynx(22,28),e.YNc(23,Et,1,0,"mat-header-cell",3),e.YNc(24,wt,13,3,"mat-cell",4),e.BQk()())}function St(n,a){1&n&&e._UZ(0,"mat-header-row")}function It(n,a){1&n&&e._UZ(0,"mat-row")}function Ot(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"table",20),e.YNc(2,gt,24,0,"ng-container",0),e.YNc(3,Ft,25,0,"ng-container",0),e.YNc(4,St,1,0,"mat-header-row",5),e.YNc(5,It,1,0,"mat-row",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("dataSource",t.tableData),e.xp6(1),e.Q6J("ngIf",!t.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",t.isPartnerRoute),e.xp6(1),e.Q6J("matHeaderRowDef",t.isPartnerRoute?t.displayedColumnsClient:t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.isPartnerRoute?t.displayedColumnsClient:t.displayedColumns)}}let ee=(()=>{class n{set filterValue(t){this._filterValue=t,this.isPartnerRoute?this.applyFilterClient():this.router.url.includes("admin")&&this.applyFilter()}constructor(t,i,o,r,l,c,m,p){this.clienteService=t,this.distribuidorService=i,this.http=o,this.auth=r,this.router=l,this.dialog=c,this.breakpointObserver=m,this.backendService=p,this.displayedColumns=["nombre","codigo","email_aviso","activo","margen","empresas","acciones"],this.displayedColumnsClient=["nombre","version","activo","fecha","codigo","facturacion","empleados","acciones"],this.element=null,this.clientes=[],this.distribuidores=[],this.currentPage=1,this.pageSize=50,this._filterValue="",this.tableData=[{id:229,dni:"11176390Y",name:"Thompson-Schuster",margin:43,companies:1,active:!0,nif:"11176390Y",type:"Partner",phone:"313301588",contract:null,codes:[{id:134,code:"est",partnerEmails:[{id:68,email:"celia51@example.org"},{id:69,email:"lhowell@example.org"},{id:70,email:"yleannon@example.net"},{id:71,email:"ondricka.anita@example.org"},{id:72,email:"dakota06@example.org"}]}],emails:[{id:68,email:"celia51@example.org"},{id:69,email:"lhowell@example.org"},{id:70,email:"yleannon@example.net"},{id:71,email:"ondricka.anita@example.org"},{id:72,email:"dakota06@example.org"}]},{id:230,dni:"71599521K",name:"Kovacek and Sons",margin:3,companies:8,active:!0,nif:"71599521K",type:"Partner Supra",phone:"168492701",contract:null,codes:[{id:125,code:"aut",partnerEmails:[{id:68,email:"celia51@example.org"}]}],emails:[{id:68,email:"celia51@example.org"}]},{id:229,dni:"11176390Y",name:"Thompson-Schuster",margin:43,companies:1,active:!0,nif:"11176390Y",type:"Partner",phone:"313301588",contract:null,codes:[{id:134,code:"est",partnerEmails:[{id:68,email:"celia51@example.org"},{id:69,email:"lhowell@example.org"},{id:70,email:"yleannon@example.net"},{id:71,email:"ondricka.anita@example.org"},{id:72,email:"dakota06@example.org"}]}],emails:[{id:68,email:"celia51@example.org"},{id:69,email:"lhowell@example.org"},{id:70,email:"yleannon@example.net"},{id:71,email:"ondricka.anita@example.org"},{id:72,email:"dakota06@example.org"}]},{id:230,dni:"71599521K",name:"Kovacek and Sons",margin:3,companies:8,active:!0,nif:"71599521K",type:"Partner Supra",phone:"168492701",contract:null,codes:[{id:125,code:"aut",partnerEmails:[{id:68,email:"celia51@example.org"}]}],emails:[{id:68,email:"celia51@example.org"}]},{id:231,dni:"92581994B",name:"Schaefer-Considine",margin:88,companies:3,active:!0,nif:"92581994B",type:"Referenciador",phone:"181111248",contract:null,codes:[{id:126,code:"facere",partnerEmails:[{id:68,email:"celia51@example.org"}]}],emails:[{id:68,email:"celia51@example.org"}]},{id:232,dni:"39943814X",name:"Gusikowski Ltd",margin:69,companies:6,active:!0,nif:"39943814X",type:"Referenciador",phone:"934857321",contract:null,codes:[{id:127,code:"dignissimos",partnerEmails:[{id:69,email:"lhowell@example.org"}]}],emails:[{id:69,email:"lhowell@example.org"}]},{id:233,dni:"43694770R",name:"Wilkinson-Cruickshank",margin:24,companies:3,active:!1,nif:"43694770R",type:"Referenciador",phone:"000324574",contract:null,codes:[{id:128,code:"eaque",partnerEmails:[{id:70,email:"yleannon@example.net"}]}],emails:[{id:70,email:"yleannon@example.net"}]},{id:234,dni:"22927468R",name:"Hirthe LLC",margin:38,companies:10,active:!0,nif:"22927468R",type:"Partner Supra",phone:"484940074",contract:null,codes:[{id:129,code:"adipisci",partnerEmails:[{id:70,email:"yleannon@example.net"}]}],emails:[{id:70,email:"yleannon@example.net"}]},{id:235,dni:"94534212V",name:"Sanford Group",margin:67,companies:3,active:!0,nif:"94534212V",type:"Referenciador",phone:"692088858",contract:null,codes:[{id:130,code:"voluptate",partnerEmails:[{id:71,email:"ondricka.anita@example.org"}]}],emails:[{id:71,email:"ondricka.anita@example.org"}]},{id:236,dni:"75001335E",name:"Heaney LLC",margin:48,companies:2,active:!1,nif:"75001335E",type:"Partner",phone:"973205511",contract:null,codes:[{id:131,code:"impedit",partnerEmails:[{id:71,email:"ondricka.anita@example.org"}]}],emails:[{id:71,email:"ondricka.anita@example.org"}]},{id:237,dni:"70588855U",name:"Bergnaum Ltd",margin:97,companies:2,active:!1,nif:"70588855U",type:"Partner",phone:"900723400",contract:null,codes:[{id:132,code:"consectetur",partnerEmails:[{id:72,email:"dakota06@example.org"}]}],emails:[{id:72,email:"dakota06@example.org"}]},{id:238,dni:"59716826C",name:"Heathcote-Dietrich",margin:63,companies:5,active:!0,nif:"59716826C",type:"Partner",phone:"579090212",contract:null,codes:[{id:133,code:"quia",partnerEmails:[{id:72,email:"dakota06@example.org"}]}],emails:[{id:72,email:"dakota06@example.org"}]},{id:239,dni:"62562625B",name:"Schmidt-Ebert",margin:69,companies:10,active:!0,nif:"62562625B",type:"Partner Supra",phone:"818242597",contract:null,codes:[{id:143,code:"quidem",partnerEmails:[{id:73,email:"marion43@example.org"},{id:74,email:"jovanny85@example.org"},{id:75,email:"cconnelly@example.com"},{id:76,email:"hkemmer@example.net"},{id:77,email:"koepp.alvera@example.com"},{id:78,email:"hill.michaela@example.org"}]}],emails:[{id:73,email:"marion43@example.org"},{id:74,email:"jovanny85@example.org"},{id:75,email:"cconnelly@example.com"},{id:76,email:"hkemmer@example.net"},{id:77,email:"koepp.alvera@example.com"},{id:78,email:"hill.michaela@example.org"}]},{id:240,dni:"85809681T",name:"Lemke-Bogan",margin:6,companies:3,active:!0,nif:"85809681T",type:"Referenciador",phone:"377778385",contract:null,codes:[{id:135,code:"sed",partnerEmails:[{id:73,email:"marion43@example.org"}]}],emails:[{id:73,email:"marion43@example.org"}]},{id:241,dni:"48622500H",name:"Cruickshank-Pacocha",margin:33,companies:5,active:!1,nif:"48622500H",type:"Partner Supra",phone:"774217851",contract:null,codes:[{id:136,code:"porro",partnerEmails:[{id:74,email:"jovanny85@example.org"}]}],emails:[{id:74,email:"jovanny85@example.org"}]},{id:242,dni:"49074937E",name:"Nolan, Bernier and Eichmann",margin:37,companies:1,active:!1,nif:"49074937E",type:"Partner",phone:"677522431",contract:null,codes:[{id:137,code:"ea",partnerEmails:[{id:75,email:"cconnelly@example.com"}]}],emails:[{id:75,email:"cconnelly@example.com"}]},{id:243,dni:"92049868L",name:"Torphy-Hayes",margin:42,companies:3,active:!1,nif:"92049868L",type:"Partner",phone:"003347002",contract:null,codes:[{id:138,code:"autem",partnerEmails:[{id:76,email:"hkemmer@example.net"}]}],emails:[{id:76,email:"hkemmer@example.net"}]},{id:244,dni:"18385866N",name:"Collier-Senger",margin:99,companies:3,active:!1,nif:"18385866N",type:"Referenciador",phone:"708558981",contract:null,codes:[{id:139,code:"doloremque",partnerEmails:[{id:77,email:"koepp.alvera@example.com"}]}],emails:[{id:77,email:"koepp.alvera@example.com"}]},{id:245,dni:"44194960F",name:"Macejkovic-Welch",margin:92,companies:8,active:!1,nif:"44194960F",type:"Referenciador",phone:"601538093",contract:null,codes:[{id:140,code:"vitae",partnerEmails:[{id:77,email:"koepp.alvera@example.com"}]}],emails:[{id:77,email:"koepp.alvera@example.com"}]},{id:246,dni:"13262671Z",name:"Cronin-Kessler",margin:82,companies:7,active:!0,nif:"13262671Z",type:"Partner Supra",phone:"657006227",contract:null,codes:[{id:141,code:"et",partnerEmails:[{id:78,email:"hill.michaela@example.org"}]}],emails:[{id:78,email:"hill.michaela@example.org"}]}],this.originalData=[...this.tableData],this.dataSource=new C.by,this.dataSourceCliente=new C.by,this.breakpointObserver.observe([g.u3.XSmall]).subscribe(b=>{this.isXSmallScreen=b.matches})}onNameClick(t){localStorage.setItem("partnerIdClick",t.toString()),this.router.navigate(["/panel/partner"])}changePage(t){t?this.currentPage++:this.currentPage--,this.fetchDistribuidores()}changePageClientes(t){t?this.currentPage++:this.currentPage--,this.fetchClientes()}onDataUpdated(){this.fetchDistribuidores()}redirectToNewDistributor(){this.router.navigate(["/panel/partner"])}ngOnInit(){this.isPartnerRoute=this.router.url.includes("partner"),this.isPartnerRoute?this.fetchClientes():this.router.url.includes("admin")&&(this.fetchDistribuidores(),console.log(this.fetchDistribuidores()))}ngAfterViewInit(){this.dataSource.paginator=this.paginator}updateDistribuidor(t){const i=this.dataSource.data.findIndex(o=>o.id===t.id);-1!==i&&(this.dataSource.data[i]=t,this.dataSource._updateChangeSubscription())}openAsignarDistribuidorModal(t){this.dialog.open(Ce,{width:"600px",data:{distribuidor:t,tableComponent:this,allDistribuidors:this.dataSource.data}})}openEditCodigoDistribuidorModal(t,i){this.dialog.open(Pe,{width:"600px",data:{codigoDistribuidor:t,distribuidor:i}}).componentInstance.dataUpdated.subscribe(()=>{this.onDataUpdated()})}toggleClienteActive(t){const i={...t,active:!t.active};this.backendService.toggleClienteActive(`http://localhost:8080/public/api/clients/${i.id}`,{active:i.active}).subscribe(l=>{console.log("Cliente active field toggled successfully"),this.updateDataSourceactive(i),t.active=!t.active},l=>{console.error(l),console.log("Error toggling Cliente active field")})}openEditarEmpresaModal(t){this.dialog.open(G,{data:{id:t.id,name:t.name,nif:t.nif}}).afterClosed().subscribe(o=>{o&&this.updateCliente(o)})}updateCliente(t){this.backendService.updateCliente(t.id,{name:t.name,nif:t.nif}).subscribe(i=>{console.log("Cliente actualizado con \xe9xito"),this.updateDataSource(t)},i=>{console.error(i),console.log("Error updating Cliente")})}updateDataSource(t){const i=this.dataSource.data.findIndex(o=>o.id===t.id);-1!==i&&(this.dataSource.data[i].name=t.name,this.dataSource.data[i].nif=t.nif,this.dataSource._updateChangeSubscription())}updateDataSourceactive(t){const i=this.dataSourceCliente.data.findIndex(o=>o.id===t.id);if(i>=0){const o=[...this.dataSourceCliente.data];o[i]=t,this.dataSourceCliente.data=o,this.dataSourceCliente._updateChangeSubscription()}}onFileSelected(t,i){this.selectedFile=t,this.uploadFile(i)}openPdf(t){this.backendService.getContractData(t).subscribe(i=>{const r=atob(i.contractData).split("").map(m=>m.charCodeAt(0)),l=new Blob([new Uint8Array(r)],{type:"application/pdf"}),c=URL.createObjectURL(l);window.open(c,"_blank")},i=>{console.error("Error al obtener los datos del contrato:",i)})}uploadFile(t){this.selectedFile?this.backendService.uploadFile(t.id,this.selectedFile).subscribe(i=>{console.log("File uploaded successfully"),t.contract=i.url},i=>{console.error("Error uploading file:",i)}):console.error("No se ha seleccionado ning\xfan archivo")}applyFilter(){const t=this._filterValue.trim().toLowerCase();this.tableData=t?this.originalData.filter(i=>{const o=i,r=o.name.toLowerCase().includes(t),l=o.codes.some(b=>b.code.toLowerCase().includes(t)),c=o.emails.some(b=>b.email.toLowerCase().includes(t)),m=o.margin.toString().startsWith(t),p=o.companies.toString().startsWith(t);return r||l||c||m||p}):[...this.originalData]}applyFilterClient(){this.dataSource.filterPredicate=(t,i)=>{if(!i)return!0;const o=t,r=i.trim().toLowerCase(),l=o.name.toLowerCase().includes(r),c=o.currentVersion.toLowerCase().includes(r),m=o.active.toString().startsWith(r),p=o.joinDate&&o.joinDate.toLowerCase().includes(r),b=o.code.code.toLowerCase().includes(r),A=o.billing&&o.billing.toLowerCase().includes(r),q=o.employees.toString().includes(r);return l||c||m||p||b||A||q||!1},this.dataSource.filter=this._filterValue,this.dataSource.paginator&&this.dataSource.paginator.firstPage()}fetchClientes(){const t=this.auth.getUserPartnerId(),i=localStorage.getItem("partnerIdClick"),o=i?parseInt(i,10):t;o&&this.clienteService.getClientesByDistribuidor(o,this.currentPage).subscribe(r=>{const l=r,c=l.map(m=>this.clienteService.getCodigoDistribuidorsByCliente(m.id));(0,de.D)(c).subscribe(m=>{this.dataSource.data=l.map((p,b)=>({id:p.id,name:p.name,currentVersion:p.currentVersion,active:p.active,joinDate:p.joinDate,nif:p.nif,billing:p.billing,employees:p.employees,leaveDate:p.leaveDate,referenceId:p.referenceId,phone:p.phone,code:m[b]}))})})}fetchDistribuidores(){return this.tableData}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(qe),e.Y36(Ne),e.Y36(h.eN),e.Y36(j.e),e.Y36(x.F0),e.Y36(u.uw),e.Y36(g.Yg),e.Y36(E))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-table"]],viewQuery:function(t,i){if(1&t&&e.Gf(w.NW,5),2&t){let o;e.iGM(o=e.CRH())&&(i.paginator=o.first)}},inputs:{filterValue:"filterValue"},decls:3,vars:3,consts:[[4,"ngIf"],["mat-table","",1,"mat-elevation-z0",3,"dataSource"],["matColumnDef","combined"],[4,"matHeaderCellDef"],[4,"matCellDef"],[4,"matHeaderRowDef"],[4,"matRowDef","matRowDefColumns"],[1,"single-column"],[2,"margin-right","2%"],[1,"blue-text"],[4,"ngFor","ngForOf"],["mat-icon-button","",3,"click"],[1,"fa-solid","fa-pen",2,"color","#729c32"],[1,"codigo-value",2,"margin-left","20%",3,"click"],[2,"margin-left","20%"],[1,"fa-solid","fa-check",2,"color","#729c32","font-size","1.2rem","margin-left","2%"],[1,"fa-solid","fa-xmark",2,"color","#729c32","font-size","1.2rem","margin-left","2%"],[2,"margin-left","2%",3,"ngClass"],[1,"fa-solid","fa-check",2,"align-items","center","color","#729c32","font-size","1.2rem","margin-left","2%"],[1,"fa-solid","fa-xmark",2,"color","red","font-size","1.2rem","margin-left","2%"],["mat-table","","matSort","",1,"mat-elevation-z0",3,"dataSource"],["matColumnDef","nombre"],[1,"columnHeader"],["mat-sort-header","",4,"matHeaderCellDef"],["class","blue-text",4,"matCellDef"],["matColumnDef","codigo"],["matColumnDef","margen"],["matColumnDef","empresas"],["matColumnDef","acciones"],["matColumnDef","email_aviso"],["matColumnDef","activo"],["mat-sort-header",""],[1,"codigo-value",3,"click"],[1,"icon-container"],["mat-icon-button","",3,"click",4,"ngIf"],[3,"fileSelected"],[1,"fa-solid","fa-paste",2,"color","#729c32"],[1,"fa-solid","fa-check",2,"align-items","center","color","#729c32","font-size","1.2rem"],[1,"fa-solid","fa-xmark",2,"color","#729c32","font-size","1.2rem"],["matColumnDef","version"],["matColumnDef","fecha"],["matColumnDef","facturacion"],["matColumnDef","empleados"],[3,"ngClass"],[1,"fa-solid","fa-xmark",2,"color","red","font-size","1.2rem"],["mat-icon-button","",3,"matMenuTriggerFor"],[1,"fa-solid","fa-ellipsis-h"],["menu","matMenu"],["mat-menu-item","",3,"click"],[1,"fa-solid","fa-pen",2,"align-items","center","color","#729c32"],[2,"margin-left","10px"],[1,"fa-solid","fa-xmark",2,"color","#729c32"],[1,"fa-solid","fa-check",2,"color","#729c32"]],template:function(t,i){1&t&&(e.YNc(0,Je,7,5,"ng-container",0),e.YNc(1,je,7,5,"ng-container",0),e.YNc(2,Ot,6,5,"ng-container",0)),2&t&&(e.Q6J("ngIf",i.isXSmallScreen&&!i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",i.isXSmallScreen&&i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",!i.isXSmallScreen))},dependencies:[_.mk,_.sg,_.O5,v.RK,U.VK,U.OP,U.p6,C.BZ,C.fO,C.as,C.w1,C.Dz,C.nj,C.ge,C.ev,C.XQ,C.Gk,X.YE,X.nU,Ee],styles:[".blue-text[_ngcontent-%COMP%]{color:#06f;text-transform:uppercase}.mat-column-codigo[_ngcontent-%COMP%]   div.codigo-value[_ngcontent-%COMP%]{display:block}.codigo-value[_ngcontent-%COMP%]{display:block;width:100%}.codigo-value[_ngcontent-%COMP%]{display:block!important}.single-column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mat-table[_ngcontent-%COMP%]{table-layout:auto}.mat-cell[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:flex-start}.mat-column-version[_ngcontent-%COMP%]{display:flex;align-items:center}"]}),n})();var Yt=d(7009);let te=(()=>{class n{constructor(t){this.http=t,this.apiUrl="http://localhost:8080/public/getActiveCodes",this.countActiveCodesUrl="http://localhost:8080/public/countActiveCodes"}fetchCodigos(){return this.http.get(this.apiUrl)}getCountActiveCodes(){return this.http.get(this.countActiveCodesUrl)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(h.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var y=d(3546);const Jt=["cardContent"];function Qt(n,a){1&n&&(e.ynx(0),e.TgZ(1,"p")(2,"strong"),e._uU(3,"Dashboard Partner"),e.qZA()(),e.BQk())}function Rt(n,a){1&n&&(e.ynx(0),e.TgZ(1,"p")(2,"strong"),e._uU(3,"Dashboard Distribuidor "),e.qZA(),e._uU(4," Dashboard Partner"),e.qZA(),e.BQk())}function $t(n,a){1&n&&(e.ynx(0),e.TgZ(1,"div",25)(2,"div",26),e._UZ(3,"i",27),e._uU(4," C\xf3digos activos "),e.qZA(),e.TgZ(5,"span",28),e._uU(6,"23"),e.qZA()(),e.TgZ(7,"div",25)(8,"div",26),e._UZ(9,"i",29),e._uU(10," Empresas totales "),e.qZA(),e.TgZ(11,"span",28),e._uU(12,"41"),e.qZA()(),e.TgZ(13,"div",25)(14,"div",26),e._UZ(15,"i",30),e._uU(16," Empresas versi\xf3n Lite "),e.qZA(),e.TgZ(17,"span",28),e._uU(18,"16"),e.qZA()(),e.TgZ(19,"div",25)(20,"div",26)(21,"div",26),e._UZ(22,"i",31),e._uU(23," Empresas versi\xf3n PRO "),e.qZA()(),e.TgZ(24,"span",28),e._uU(25,"25"),e.qZA()(),e.BQk())}function Vt(n,a){1&n&&(e.ynx(0),e.TgZ(1,"div",25)(2,"div",26),e._UZ(3,"i",29),e._uU(4," Empresas activas "),e.qZA(),e.TgZ(5,"span",28),e._uU(6,"26"),e.qZA()(),e.TgZ(7,"div",25)(8,"div",26),e._UZ(9,"i",29),e._uU(10," Empleados totales "),e.qZA(),e.TgZ(11,"span",28),e._uU(12,"125"),e.qZA()(),e.BQk())}function Bt(n,a){1&n&&(e.ynx(0),e.TgZ(1,"mat-card-header",7),e._uU(2," Datos econ\xf3micos "),e.qZA(),e.TgZ(3,"mat-card-content")(4,"div",25)(5,"div",26),e._UZ(6,"i",32),e._uU(7," Ingresos (a facturar) "),e.qZA()(),e.TgZ(8,"div",25)(9,"div",26),e._UZ(10,"i",33),e._uU(11," Pr\xf3xima factura partners "),e.qZA()(),e.TgZ(12,"div",25)(13,"div",26),e._UZ(14,"i",34),e._uU(15," Beneficio mensual "),e.qZA()(),e.TgZ(16,"button",35)(17,"strong"),e._uU(18,"Obtener facturaci\xf3n"),e.qZA()()(),e.BQk())}function Lt(n,a){1&n&&(e.ynx(0),e.TgZ(1,"mat-card-header",7),e._uU(2," Versiones "),e.qZA(),e.TgZ(3,"div",25)(4,"div",26),e._UZ(5,"i",30),e._uU(6," Empresas versi\xf3n LITE "),e.qZA(),e.TgZ(7,"span",36),e._uU(8,"29"),e.qZA()(),e.TgZ(9,"div",25)(10,"div",26),e._UZ(11,"i",31),e._uU(12," Empresas versi\xf3n PRO "),e.qZA(),e.TgZ(13,"span",36),e._uU(14,"12"),e.qZA()(),e.BQk())}function jt(n,a){1&n&&(e.ynx(0),e.TgZ(1,"mat-card-header",7),e._uU(2," Tipo de partner "),e.qZA(),e.TgZ(3,"mat-card-content")(4,"div",37)(5,"span"),e._UZ(6,"i",38),e._uU(7," Referenciador "),e.qZA(),e.TgZ(8,"span",28),e._uU(9,"11"),e.qZA()(),e.TgZ(10,"div",39)(11,"span"),e._UZ(12,"i",40),e._uU(13,"Partner Supra "),e.qZA(),e.TgZ(14,"span",28),e._uU(15,"24"),e.qZA()(),e.TgZ(16,"div",41)(17,"span"),e._UZ(18,"i",42),e._uU(19,"Partner "),e.qZA(),e.TgZ(20,"span",28),e._uU(21,"34"),e.qZA()()(),e.BQk())}function Ht(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"mat-card-header",7),e._uU(2," Datos econ\xf3micos "),e.qZA(),e.TgZ(3,"mat-card-content")(4,"div",25)(5,"div",26),e._UZ(6,"i",27),e._uU(7," C\xf3digos activos "),e.qZA(),e.TgZ(8,"span",43),e._uU(9),e.qZA()(),e.TgZ(10,"div",25)(11,"div",26),e._UZ(12,"i",33),e._uU(13," Pr\xf3xima factura partners "),e.qZA()(),e.TgZ(14,"div",25)(15,"div",26),e._UZ(16,"i",34),e._uU(17," Beneficio mensual "),e.qZA()(),e.TgZ(18,"button",35)(19,"strong"),e._uU(20,"Obtener facturaci\xf3n"),e.qZA()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(9),e.Oqu(t.countCodigosDistri)}}function Gt(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",44),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.redirectToNewDistribudor())}),e._UZ(2,"i",45),e._uU(3," Nuevo distribuidor "),e.qZA(),e.BQk()}}function Kt(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",44),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.openModalAsignar())}),e._UZ(2,"i",45),e._uU(3," Asignar distribuidor "),e.qZA(),e.TgZ(4,"button",46),e._UZ(5,"i",47),e._uU(6," Sincronizar "),e.qZA(),e.TgZ(7,"mat-menu",null,48)(9,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.sendRequestHoldedCommand())}),e._uU(10,"Todos"),e.qZA(),e.TgZ(11,"button",49),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.sendRequestHoldedCommand(!1))}),e._uU(12,"Recientes"),e.qZA()(),e.BQk()}if(2&n){const t=e.MAs(8);e.xp6(4),e.Q6J("matMenuTriggerFor",t)}}function zt(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",44),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.redirectToNewEmpresa())}),e._UZ(2,"i",45),e._uU(3," Nueva empresa "),e.qZA(),e.BQk()}}const Xt=function(){return[50,50]};let Wt=(()=>{class n{sendRequestHoldedCommand(t){let i="http://localhost:8080/public/syncWithHolded";!1===t&&(i+="?sendBoolean=false"),this.http.get(i).subscribe(o=>{this.snackBar.open(!1===t?"\xc9xito al incorporar los contactos recientes de Holded":"Exito al incorporar TODOS los contacto de Holded","Close",{duration:1e3})},o=>{console.error(o),this.snackBar.open("Error syncing contacts with Holded","Close",{duration:1e3})})}sendPostRequest(){this.http.get("/api/sync-with-holded").subscribe(t=>{this.snackBar.open("Contacts synced with Holded","Close",{duration:1e3})},t=>{console.error(t),this.snackBar.open("Error syncing contacts with Holded","Close",{duration:1e3})})}onRecientesClick(){console.log("Recientes clicked"),this.sendRequestHoldedCommand(!1)}onTodosClick(){console.log("Todos clicked"),this.sendRequestHoldedCommand(!0)}nextPage(){this.isPartnerRoute||this.tableComponent.changePage(!0),this.currentPage++}previousPage(){this.isPartnerRoute||this.tableComponent.changePage(!1),this.currentPage--}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}onSingleClick(){this.singleClick$.next()}onDoubleClick(){this.singleClick$.next(),this.doubleClick$.next()}ngOnInit(){this.isPartnerRoute=this.router.url.includes("partner"),this.currentPage=1,this.calculatePages(),this.getSumEmpresas(),this.breakpointObserver.observe([g.u3.XSmall,g.u3.Small]).subscribe(t=>{this.isSmallScreen=t.matches}),this.fetchCountActiveCodes(),this.getSumEmpresas(),this.getSumEmpresasRef(),this.getSumEmpresasPartner(),this.getSumEmpresasSupra(),this.getSumLite(),this.getSumPro(),this.fetchPartnerMetrics()}get isSmallScreen(){return this._isSmallScreen}set isSmallScreen(t){this._isSmallScreen=t}getSumEmpresas(){this.http.get("http://localhost:8080/public/sumCompanies").subscribe(t=>{this.sumEmpresas=t},t=>{console.error(t),console.log("Error fetching sum of empresas")})}getSumEmpresasRef(){this.http.get("http://localhost:8080/public/sumReferenciadorCompanies").subscribe(t=>{this.sumEmpresasRef=t},t=>{console.error(t),console.log("Error fetching sum of empresas")})}getSumEmpresasPartner(){this.http.get("http://localhost:8080/public/sumPartnerCompanies").subscribe(t=>{this.sumEmpresasPartner=t},t=>{console.error(t),console.log("Error fetching sum of empresas")})}getSumEmpresasSupra(){this.http.get("http://localhost:8080/public/sumSupraCompanies").subscribe(t=>{this.sumEmpresasSupra=t,console.log(this.sumEmpresasSupra)},t=>{console.error(t),console.log("Error fetching sum of empresas")})}getSumLite(){this.http.get("http://localhost:8080/public/sumLite").subscribe(t=>{this.sumLite=t},t=>{console.error(t),console.log("Error fetching sum of empresas")})}getSumPro(){this.http.get("http://localhost:8080/public/sumPro").subscribe(t=>{this.sumPro=t},t=>{console.error(t),console.log("Error fetching sum of empresas")})}fetchPartnerMetrics(){const t=localStorage.getItem("partnerIdClick")||localStorage.getItem("user_partner_id");t?this.http.get(`http://localhost:8080/public/partnerMetrics/${t}`).subscribe(i=>{this.sumProDistri=i.proVersionClients,this.sumLiteDistri=i.liteVersionClients,this.sumEmpleados=i.sumEmployees,this.countCodigosDistri=i.partnerCodesCount,this.sumEmpresasDistri=i.activeClientsCount},i=>{console.error("Error fetching partner metrics:",i)}):console.log("partnerIdClick or user_partner_id not found in localStorage")}onFilterChange(t){this.filterValue=t.target.value,this.isPartnerRoute?this.tableComponent.applyFilterClient():this.tableComponent.applyFilter()}openModalEditarEmpresa(){this.dialog.open(G,{width:this.isSmallScreen?"25%":"20%",maxWidth:"100vw",maxHeight:"100vh",panelClass:this.isSmallScreen?"full-screen-dialog":"default-dialog"}).afterClosed().subscribe(i=>{console.log("The dialog was closed"),console.log(i)})}openModalAsignar(){this.tableComponent.dataSource.data.length>0?this.tableComponent.openAsignarDistribuidorModal(this.tableComponent.dataSource.data[0]):console.log("No data available in the table")}get filteredData(){return this.data.filter(t=>t.toLowerCase().includes(this.searchTerm.toLowerCase()))}updatePages(){this.pages=[];const t=Math.max(1,this.currentPage-3),i=Math.min(this.totalPages,this.currentPage+3);for(let o=t;o<=i;o++)this.pages.push(o)}onPageChange(t){this.currentPage=t.pageIndex+1}isFirstPage(){return 1===this.currentPage}isLastPage(){return this.currentPage===this.totalPages}get totalPages(){return Math.ceil(this.totalItems/this.pageSize)}goToPage(t){this.currentPage=t,this.updatePages()}calculatePages(){let i=1,o=this.totalPages;this.totalPages>5&&(i=Math.max(this.currentPage-2,1),o=Math.min(this.currentPage+2,this.totalPages),1===i?o=i+5-1:o===this.totalPages&&(i=o-5+1)),this.pages=Array.from(Array(o-i+1),(r,l)=>i+l)}redirectToNewDistribudor(){this.router.navigate(["/panel/admin/nuevoPartner"])}redirectToNewEmpresa(){this.router.navigate(["/panel/partner/nuevaEmpresa"])}fetchCountActiveCodes(){this.codeService.getCountActiveCodes().subscribe(t=>{this.sumCodigosActivos=t},t=>{console.error(t),console.log("Error fetching count of active codes")})}constructor(t,i,o,r,l,c,m){this.breakpointObserver=t,this.dialog=i,this.router=o,this.backend=r,this.http=l,this.snackBar=c,this.codeService=m,this.contentHeightChanged=new e.vpe,this.cols=1,this.username="",this.role="",this.singleClick$=new N.x,this.doubleClick$=new N.x,this.destroy$=new N.x,this.totalItems=100,this.pageSize=10,this.currentPage=1,this.pages=[],this.searchTerm="",this.data=["John","Jane","Bob","Alice"],this.placeholder="Introduce una b\xfasqueda...",this.filterValue="",this.sumEmpresas=0,this.sumEmpresasRef=0,this.sumEmpresasSupra=0,this.sumEmpresasPartner=0,this.sumLite=0,this.sumPro=0,this.sumCodigosActivos=0,this.sumEmpresasDistri=0,this.sumEmpleados=0,this.countCodigosDistri=0,this.sumLiteDistri=0,this.sumProDistri=0,this.router=o,this.breakpointObserver.observe([g.u3.XSmall,g.u3.Small,g.u3.Medium,g.u3.Large,g.u3.XLarge]).subscribe(p=>{p.breakpoints[g.u3.XSmall]?(this.tileCols=4,this.tileRows=8,this.searchBarRowspan=3,this.largeCardRowspan=1090):p.breakpoints[g.u3.Small]?(this.tileCols=2,this.tileRows=8,this.searchBarRowspan=3,this.largeCardRowspan=1090):p.breakpoints[g.u3.Medium]?(this.tileCols=2,this.tileRows=8,this.searchBarRowspan=3,this.largeCardRowspan=1086):(this.tileCols=1,this.tileRows=8,this.searchBarRowspan=3,this.largeCardRowspan=1090)})}getDistribuidores(){this.backend.getDistribudors().subscribe(t=>{console.log(t),this.data=t})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g.Yg),e.Y36(u.uw),e.Y36(x.F0),e.Y36(E),e.Y36(h.eN),e.Y36(Yt.ux),e.Y36(te))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-dashboard"]],viewQuery:function(t,i){if(1&t&&(e.Gf(Jt,5),e.Gf(ee,5)),2&t){let o;e.iGM(o=e.CRH())&&(i.cardContent=o.first),e.iGM(o=e.CRH())&&(i.tableComponent=o.first)}},inputs:{username:"username",role:"role"},outputs:{contentHeightChanged:"contentHeightChanged"},decls:61,vars:24,consts:[[4,"ngIf"],[1,"grid-container","dashboard-container"],[1,"flex-container"],[1,"flex-item"],[1,"dashboard-card","image"],["mat-card-image","","clas","logo","src","assets/images/android.svg","alt","Logo"],[1,"dashboard-card"],[1,"bold-header"],[1,"dashboard-card-search"],["appearance","fill","subscriptSizing","dynamic",1,"custom-class"],["matPrefix",""],[2,"margin-left","2rem"],["matInput","",3,"placeholder","keyup"],["input",""],[1,"dashboard-card","large-card"],[1,"center-num",3,"length","pageSizeOptions","page"],[1,"button-container"],["mat-button","",3,"disabled","click"],["mat-button","",1,"green",3,"disabled"],["mat-button","",3,"click"],[1,"dashboard-card-content",2,"height","100%"],[1,"table-container"],[3,"filterValue"],[1,"pagination"],["mat-button","",1,"green","small",3,"disabled"],[1,"card-item"],[1,"icon-text-container"],[1,"fa-solid","fa-percent",2,"color","rgb(134, 188, 38)"],[1,"data-card"],[1,"fa-solid","fa-industry",2,"color","rgb(134, 188, 38)"],[1,"fa-solid","fa-angle-up",2,"color","rgb(134, 188, 38)"],[1,"fa-solid","fa-angles-up",2,"color","rgb(134, 188, 38)"],[1,"fa-solid","fa-euro-sign",2,"color","rgb(134, 188, 38)"],[1,"fa-solid","fa-file-invoice",2,"color","rgb(134, 188, 38)"],[1,"fa-solid","fa-calendar-check",2,"color","rgb(134, 188, 38)"],["mat-button","",1,"card-item",2,"color","rgb(134, 188, 38)","font-size","0.8rem"],[1,"data-card",2,"margin-right","12px"],[1,"card-item","yellow-border"],[1,"fa-solid","fa-briefcase",2,"color","#F4C430"],[1,"card-item","green-border"],[1,"fa-solid","fa-briefcase",2,"color","rgb(134, 188, 38)"],[1,"card-item","blue-border"],[1,"fa-solid","fa-briefcase",2,"color","#0096FF"],[1,"data-card",2,"margin-right","6px"],["mat-flat-button","",1,"green",3,"click"],[1,"fa-solid","fa-circle-plus"],["mat-flat-button","",1,"green",3,"matMenuTriggerFor"],[1,"fa-solid","fa-arrows-rotate",2,"color","#ffffff"],["menu","matMenu"],["mat-menu-item","",3,"click"]],template:function(t,i){1&t&&(e.YNc(0,Qt,4,0,"ng-container",0),e.YNc(1,Rt,5,0,"ng-container",0),e.TgZ(2,"div",1)(3,"div",2)(4,"div",3)(5,"mat-card",4),e._UZ(6,"mat-card-header")(7,"img",5),e.qZA()(),e.TgZ(8,"div",3)(9,"mat-card",6)(10,"mat-card-header",7),e._uU(11," Servicios "),e.qZA(),e.TgZ(12,"mat-card-content"),e.YNc(13,$t,26,0,"ng-container",0),e.YNc(14,Vt,13,0,"ng-container",0),e.qZA()()(),e.TgZ(15,"div",3)(16,"mat-card",6),e.YNc(17,Bt,19,0,"ng-container",0),e.YNc(18,Lt,15,0,"ng-container",0),e.qZA()(),e.TgZ(19,"div",3)(20,"mat-card",6),e.YNc(21,jt,22,0,"ng-container",0),e.YNc(22,Ht,21,1,"ng-container",0),e.qZA()()(),e.TgZ(23,"div",2)(24,"div",3)(25,"mat-card",8)(26,"mat-form-field",9)(27,"mat-icon-button",10)(28,"mat-icon",11),e._uU(29,"search"),e.qZA()(),e.TgZ(30,"input",12,13),e.NdJ("keyup",function(r){return i.onFilterChange(r)}),e.qZA()()()()(),e.TgZ(32,"div",2)(33,"div",3)(34,"mat-card",14)(35,"mat-card-header")(36,"mat-paginator",15),e.NdJ("page",function(r){return i.onPageChange(r)}),e.qZA(),e.TgZ(37,"div",16),e.YNc(38,Gt,4,0,"ng-container",0),e.YNc(39,Kt,13,1,"ng-container",0),e.YNc(40,zt,4,0,"ng-container",0),e.qZA(),e.TgZ(41,"div")(42,"button",17),e.NdJ("click",function(){return i.previousPage()}),e._uU(43,"Anterior"),e.qZA(),e.TgZ(44,"button",18),e._uU(45),e.qZA(),e.TgZ(46,"button",19),e.NdJ("click",function(){return i.nextPage()}),e._uU(47,"Siguiente"),e.qZA()()(),e.TgZ(48,"mat-card-content",20)(49,"div",21),e._UZ(50,"app-table",22),e.qZA()(),e.TgZ(51,"mat-card-footer")(52,"div",23),e._UZ(53,"div"),e.TgZ(54,"div")(55,"button",17),e.NdJ("click",function(){return i.previousPage()}),e._uU(56,"Anterior"),e.qZA(),e.TgZ(57,"button",24),e._uU(58),e.qZA(),e.TgZ(59,"button",19),e.NdJ("click",function(){return i.nextPage()}),e._uU(60,"Siguiente"),e.qZA()()()()()()()()),2&t&&(e.Q6J("ngIf",!i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",i.isPartnerRoute),e.xp6(12),e.Q6J("ngIf",!i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",i.isPartnerRoute),e.xp6(3),e.Q6J("ngIf",!i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",i.isPartnerRoute),e.xp6(3),e.Q6J("ngIf",!i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",i.isPartnerRoute),e.xp6(8),e.s9C("placeholder",i.placeholder),e.xp6(6),e.ekj("disabled-paginator-option",!0),e.Q6J("length",i.totalItems)("pageSizeOptions",e.DdM(23,Xt)),e.xp6(2),e.Q6J("ngIf",!i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",!i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",i.isPartnerRoute),e.xp6(2),e.Q6J("disabled",i.isFirstPage()),e.xp6(2),e.Q6J("disabled",!0),e.xp6(1),e.Oqu(i.currentPage),e.xp6(5),e.Q6J("filterValue",i.filterValue),e.xp6(5),e.Q6J("disabled",i.isFirstPage()),e.xp6(2),e.Q6J("disabled",!0),e.xp6(1),e.Oqu(i.currentPage))},dependencies:[_.O5,v.lW,y.a8,y.dn,y.rt,y.dk,y.G2,f.KE,f.qo,P.Hw,M.Nt,U.VK,U.OP,U.p6,w.NW,ee],styles:["p[_ngcontent-%COMP%]{padding-top:2.5%;margin-left:2%}.mat-select-arrow[_ngcontent-%COMP%]{border:none!important}.dashboard-form-field[_ngcontent-%COMP%]{height:100%}.mat-mdc-form-field-hint-spacer[_ngcontent-%COMP%]{display:none}.search-field[_ngcontent-%COMP%]{height:100%}.more-button[_ngcontent-%COMP%]{position:absolute;top:5px;right:10px}.card-header-buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:-12px;margin-right:-12px}.page-size-label[_ngcontent-%COMP%]{display:block;font-size:1.2rem;font-weight:700;margin-bottom:.5rem}.dashboard-card.large-card[_ngcontent-%COMP%]{display:flex!important;flex-direction:column!important;height:100%!important}.mat-paginator[_ngcontent-%COMP%]{flex-grow:0;margin-right:auto}.button-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;margin-left:auto;flex-wrap:wrap}.button-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-bottom:5px;margin-right:5px}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.pagination[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}.info[_ngcontent-%COMP%]{margin-left:1.5rem}.mat-mdc-form-field-infix[_ngcontent-%COMP%]{display:inline-block;width:auto}  .mdc-line-ripple:after{border-bottom-width:0!important}.mat-mdc-form-field.mat-mdc-form-field-type-mat-select[_ngcontent-%COMP%]   .mat-form-field-underline[_ngcontent-%COMP%]{display:none!important}.my-custom-field[_ngcontent-%COMP%]   .mat-form-field-underline[_ngcontent-%COMP%], .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%], .mat-form-field-underline[_ngcontent-%COMP%]{display:none}  .custom-class .mat-form-field-underline{display:none}.mat-form-field[_ngcontent-%COMP%]   .mdc-line-ripple[_ngcontent-%COMP%]{display:none}  .mat-form-field-underline{display:none!important}.mat-form-field-underline[_ngcontent-%COMP%]{display:none}  .mat-form-field-appearance-outline.mat-form-field-disabled,   .mat-form-field-outline{opacity:0}  .search-field .mat-form-field-underline{display:none}  .mat-form-field-underline{display:none}.bold-header[_ngcontent-%COMP%]{font-weight:700}.card-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin:.5rem 0}.card-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px;padding-left:10px}.yellow-border[_ngcontent-%COMP%]{border:2px solid rgb(250,241,211);margin:1rem 0}.blue-border[_ngcontent-%COMP%]{border:2px solid #0096FF;margin:1rem 0}.green-border[_ngcontent-%COMP%]{border:2px solid rgb(134,188,38);margin:1rem 0}  .mat-mdc-paginator-range-label{display:none!important}.mat-select-value-text[_ngcontent-%COMP%]{text-align:center}.mat-form-field[_ngcontent-%COMP%]{width:auto}.green[_ngcontent-%COMP%]{background-color:#86bc26}.title[_ngcontent-%COMP%]{margin-top:2.5rem}.data[_ngcontent-%COMP%]{float:right}.mat-card[_ngcontent-%COMP%]{display:flex;flex-direction:column}.mat-card-content[_ngcontent-%COMP%]{flex-grow:1}.card-hrlog[_ngcontent-%COMP%]{justify-content:center}.img-hrlog[_ngcontent-%COMP%]{width:100%!important;padding:20%;min-width:150px}.mat-select[_ngcontent-%COMP%]{width:auto;margin:0 auto;display:flex;align-items:center;justify-content:center}.card-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.flex-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between}.flex-item[_ngcontent-%COMP%]{flex:1;margin:15px;display:flex;flex-direction:column;min-width:calc(25% - 30px)}@media (max-width: 1200px){.flex-item[_ngcontent-%COMP%]{min-width:calc(50% - 30px)}}@media (max-width: 690px){.flex-item[_ngcontent-%COMP%]{min-width:60%;max-width:95%;margin-left:10px;margin-right:0%}.sidebar[_ngcontent-%COMP%]{display:none!important}}.dashboard-card[_ngcontent-%COMP%]{flex-grow:1}.image[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center}.dashboard-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-width:50%;align-self:center}.small[_ngcontent-%COMP%]{padding:0;background-size:5px!important}"]}),n})();var D=d(3900),en=d(9751),tn=d(1005);let nn=(()=>{class n{validate(t){const i=t.value;return new en.y(r=>{console.log({email:i}),"pablo@google.com"===i&&(r.next({emailTaken:!0}),r.complete()),r.next(null),r.complete()}).pipe((0,tn.g)(3e3))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function on(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function an(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function rn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe elegir un valor. "),e.qZA())}function ln(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe estar entre 0 y 100. "),e.qZA())}function sn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function cn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe ser 8 d\xedgitos seguidos de una letra may\xfascula. "),e.qZA())}function dn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function mn(n,a){if(1&n&&(e.TgZ(0,"mat-option",33),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.code)}}function pn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe elegir un valor. "),e.qZA())}function un(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe elegir un valor. "),e.qZA())}function gn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe estar entre 0 y 100. "),e.qZA())}function _n(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function hn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function fn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function bn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function Cn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe ser un correo electr\xf3nico v\xe1lido. "),e.qZA())}function vn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," La contrase\xf1a debe tener al menos 6 caracteres. "),e.qZA())}function Zn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Las contrase\xf1as deben coincidir. "),e.qZA())}function Tn(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onSubmit())}),e.TgZ(2,"h3"),e._uU(3,"Datos del distribuidor"),e.qZA(),e.TgZ(4,"div")(5,"div",3)(6,"mat-label")(7,"span",4),e._uU(8,"*"),e.qZA(),e._uU(9," Nuevo c\xf3digo promocional"),e.qZA()(),e.TgZ(10,"div",5)(11,"mat-form-field",6),e._UZ(12,"input",7),e.YNc(13,on,2,0,"mat-error",1),e.qZA()()(),e.TgZ(14,"div")(15,"div",3)(16,"mat-label")(17,"span",4),e._uU(18,"*"),e.qZA(),e._uU(19," Email de aviso"),e.qZA()(),e.TgZ(20,"div",5)(21,"mat-form-field",6),e._UZ(22,"input",8),e.YNc(23,an,2,0,"mat-error",1),e.qZA()()(),e.TgZ(24,"div")(25,"div",3)(26,"mat-label")(27,"span",4),e._uU(28,"*"),e.qZA(),e._uU(29," Tipo de distribuidor"),e.qZA()(),e.TgZ(30,"div",5)(31,"mat-form-field",6)(32,"mat-select",9)(33,"mat-option",10),e._uU(34,"Partner"),e.qZA(),e.TgZ(35,"mat-option",11),e._uU(36,"Partner Supra"),e.qZA(),e.TgZ(37,"mat-option",12),e._uU(38,"Referenciador"),e.qZA()(),e.YNc(39,rn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(40,"div")(41,"div",3)(42,"mat-label")(43,"span",4),e._uU(44,"*"),e.qZA(),e._uU(45," Margen"),e.qZA()(),e.TgZ(46,"div",5)(47,"mat-form-field",6),e._UZ(48,"input",13),e.YNc(49,ln,2,0,"mat-error",1),e.qZA()()(),e.TgZ(50,"h3"),e._uU(51,"Datos de la empresa"),e.qZA(),e.TgZ(52,"div")(53,"div",3)(54,"mat-label")(55,"span",4),e._uU(56,"*"),e.qZA(),e._uU(57," Nombre de la empresa"),e.qZA()(),e.TgZ(58,"div",5)(59,"mat-form-field",6),e._UZ(60,"input",14),e.YNc(61,sn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(62,"div")(63,"div",3)(64,"mat-label")(65,"span",4),e._uU(66,"*"),e.qZA(),e._uU(67," NIF"),e.qZA()(),e.TgZ(68,"div",5)(69,"mat-form-field",6),e._UZ(70,"input",15),e.YNc(71,cn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(72,"div")(73,"div",3)(74,"mat-label")(75,"span",4),e._uU(76,"*"),e.qZA(),e._uU(77," Tel\xe9fono"),e.qZA()(),e.TgZ(78,"div",5)(79,"mat-form-field",6),e._UZ(80,"input",16),e.YNc(81,dn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(82,"div")(83,"div",3)(84,"mat-label")(85,"span",4),e._uU(86,"*"),e.qZA(),e._uU(87," C\xf3digo"),e.qZA()(),e.TgZ(88,"div",5)(89,"mat-form-field",6)(90,"mat-select",17),e.YNc(91,mn,2,2,"mat-option",18),e.qZA(),e.YNc(92,pn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(93,"div")(94,"div",3)(95,"mat-label")(96,"span",4),e._uU(97,"*"),e.qZA(),e._uU(98," Versi\xf3n "),e.qZA()(),e.TgZ(99,"div")(100,"mat-form-field",6)(101,"mat-select",19)(102,"mat-option",20),e._uU(103,"Lite"),e.qZA(),e.TgZ(104,"mat-option",21),e._uU(105,"Pro"),e.qZA()(),e.YNc(106,un,2,0,"mat-error",1),e.qZA()()(),e.TgZ(107,"div")(108,"div",3)(109,"mat-label")(110,"span",4),e._uU(111,"*"),e.qZA(),e._uU(112," Empleados"),e.qZA()(),e.TgZ(113,"div",5)(114,"mat-form-field",6),e._UZ(115,"input",22),e.YNc(116,gn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(117,"div")(118,"div",3)(119,"mat-label")(120,"span"),e._uU(121,"*"),e.qZA(),e._uU(122," Grupo de facturaci\xf3n"),e.qZA()(),e.TgZ(123,"div",5)(124,"mat-form-field",6),e._UZ(125,"input",23),e.YNc(126,_n,2,0,"mat-error",1),e.qZA()()(),e.TgZ(127,"h3"),e._uU(128,"Datos del usuario"),e.qZA(),e.TgZ(129,"div")(130,"div",3)(131,"mat-label")(132,"span",4),e._uU(133,"*"),e.qZA(),e._uU(134," Nombre"),e.qZA()(),e.TgZ(135,"div",5)(136,"mat-form-field",6),e._UZ(137,"input",24),e.YNc(138,hn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(139,"div")(140,"div",3)(141,"mat-label")(142,"span",4),e._uU(143,"*"),e.qZA(),e._uU(144," Apellidos"),e.qZA()(),e.TgZ(145,"div",5)(146,"mat-form-field",6),e._UZ(147,"input",25),e.YNc(148,fn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(149,"div")(150,"div",3)(151,"mat-label")(152,"span",4),e._uU(153,"*"),e.qZA(),e._uU(154," DNI"),e.qZA()(),e.TgZ(155,"div",5)(156,"mat-form-field",6),e._UZ(157,"input",26),e.YNc(158,bn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(159,"div")(160,"div",3)(161,"mat-label")(162,"span",4),e._uU(163,"*"),e.qZA(),e._uU(164," Email"),e.qZA()(),e.TgZ(165,"div",5)(166,"mat-form-field",6),e._UZ(167,"input",27),e.YNc(168,Cn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(169,"div")(170,"div",3)(171,"mat-label")(172,"span",4),e._uU(173,"*"),e.qZA(),e._uU(174," Contrase\xf1a"),e.qZA()(),e.TgZ(175,"div",5)(176,"mat-form-field",6),e._UZ(177,"input",28),e.YNc(178,vn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(179,"div")(180,"div",3)(181,"mat-label")(182,"span",4),e._uU(183,"*"),e.qZA(),e._uU(184," Repita contrase\xf1a"),e.qZA()(),e.TgZ(185,"div",5)(186,"mat-form-field",6),e._UZ(187,"input",29),e.YNc(188,Zn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(189,"div")(190,"div",3)(191,"mat-label")(192,"span",4),e._uU(193,"*"),e.qZA(),e._uU(194," Rol del usuario"),e.qZA()(),e.TgZ(195,"div"),e._UZ(196,"label",30),e.TgZ(197,"div",5)(198,"mat-checkbox",31)(199,"mat-label"),e._uU(200,"Administrador"),e.qZA()()()()(),e.TgZ(201,"div")(202,"button",32),e._uU(203," Guardar "),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.myForm),e.xp6(12),e.Q6J("ngIf",t.isValidField("nuevoCodigo")),e.xp6(10),e.Q6J("ngIf",t.isValidField("warningEmails")),e.xp6(16),e.Q6J("ngIf",t.isValidField("type")),e.xp6(10),e.Q6J("ngIf",t.isValidField("margin")),e.xp6(12),e.Q6J("ngIf",t.isValidField("companyName")),e.xp6(10),e.Q6J("ngIf",t.isValidField("nif")),e.xp6(10),e.Q6J("ngIf",t.isValidField("phone")),e.xp6(10),e.Q6J("ngForOf",t.codes),e.xp6(1),e.Q6J("ngIf",t.isValidField("code")),e.xp6(14),e.Q6J("ngIf",t.isValidField("code")),e.xp6(10),e.Q6J("ngIf",t.isValidField("margin")),e.xp6(10),e.Q6J("ngIf",t.isValidField("nuevoCodigo")),e.xp6(12),e.Q6J("ngIf",t.isValidField("name")),e.xp6(10),e.Q6J("ngIf",t.isValidField("surname")),e.xp6(10),e.Q6J("ngIf",t.isValidField("dni")),e.xp6(10),e.Q6J("ngIf",t.isValidField("email")),e.xp6(10),e.Q6J("ngIf",t.isValidField("password")),e.xp6(10),e.Q6J("ngIf",t.isValidField("password2"))}}function xn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function yn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe ser 8 d\xedgitos seguidos de una letra may\xfascula. "),e.qZA())}function An(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Este campo es obligatorio. "),e.qZA())}function Un(n,a){if(1&n&&(e.TgZ(0,"mat-option",33),e._uU(1),e.qZA()),2&n){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.Oqu(t.code)}}function Dn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe elegir un valor. "),e.qZA())}function Pn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe elegir un valor. "),e.qZA())}function qn(n,a){1&n&&(e.TgZ(0,"mat-error"),e._uU(1," Debe estar entre 0 y 100. "),e.qZA())}function Nn(n,a){1&n&&(e.ynx(0),e._UZ(1,"div"),e.BQk())}function En(n,a){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"form",2),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.onSubmitClient())}),e.TgZ(2,"h3"),e._uU(3,"Datos de la empresa"),e.qZA(),e.TgZ(4,"div")(5,"div",3)(6,"mat-label")(7,"span",4),e._uU(8,"*"),e.qZA(),e._uU(9," Nombre de la empresa"),e.qZA()(),e.TgZ(10,"div",5)(11,"mat-form-field",6),e._UZ(12,"input",14),e.YNc(13,xn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(14,"div")(15,"div",3)(16,"mat-label")(17,"span",4),e._uU(18,"*"),e.qZA(),e._uU(19," NIF"),e.qZA()(),e.TgZ(20,"div",5)(21,"mat-form-field",6),e._UZ(22,"input",15),e.YNc(23,yn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(24,"div")(25,"div",3)(26,"mat-label")(27,"span",4),e._uU(28,"*"),e.qZA(),e._uU(29," Tel\xe9fono"),e.qZA()(),e.TgZ(30,"div",5)(31,"mat-form-field",6),e._UZ(32,"input",16),e.YNc(33,An,2,0,"mat-error",1),e.qZA()()(),e.TgZ(34,"div")(35,"div",3)(36,"mat-label")(37,"span",4),e._uU(38,"*"),e.qZA(),e._uU(39," C\xf3digo"),e.qZA()(),e.TgZ(40,"div",5)(41,"mat-form-field",6)(42,"mat-select",17),e.YNc(43,Un,2,2,"mat-option",18),e.qZA(),e.YNc(44,Dn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(45,"div")(46,"div",3)(47,"mat-label")(48,"span",4),e._uU(49,"*"),e.qZA(),e._uU(50," Versi\xf3n"),e.qZA()(),e.TgZ(51,"div")(52,"mat-form-field",6)(53,"mat-select",19)(54,"mat-option",20),e._uU(55,"Lite"),e.qZA(),e.TgZ(56,"mat-option",21),e._uU(57,"Pro"),e.qZA()(),e.YNc(58,Pn,2,0,"mat-error",1),e.qZA()()(),e.TgZ(59,"div")(60,"div",3)(61,"mat-label")(62,"span",4),e._uU(63,"*"),e.qZA(),e._uU(64," Empleados"),e.qZA()(),e.TgZ(65,"div",5)(66,"mat-form-field",6),e._UZ(67,"input",22),e.YNc(68,qn,2,0,"mat-error",1),e.qZA()()(),e.YNc(69,Nn,2,0,"ng-container",1),e.TgZ(70,"div")(71,"button",32),e._uU(72," Guardar "),e.qZA()()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.myForm),e.xp6(12),e.Q6J("ngIf",t.isValidField("companyName")),e.xp6(10),e.Q6J("ngIf",t.isValidField("nif")),e.xp6(10),e.Q6J("ngIf",t.isValidField("phone")),e.xp6(10),e.Q6J("ngForOf",t.codes),e.xp6(1),e.Q6J("ngIf",t.isValidField("code")),e.xp6(14),e.Q6J("ngIf",t.isValidField("code")),e.xp6(10),e.Q6J("ngIf",t.isValidField("margin")),e.xp6(1),e.Q6J("ngIf",t.isPartnerRoute)}}let $=(()=>{class n{constructor(t,i,o,r,l,c){this.fb=t,this.validatorsService=i,this.emailValidator=o,this.http=r,this.router=l,this.codeService=c,this.myForm=this.fb.group({phone:["",[s.kI.maxLength(9)]],employees:[0,[]],billing:[],nuevoCodigo:["",[s.kI.required,s.kI.minLength(1)]],warningEmails:[],type:[],margin:[0,[s.kI.required,s.kI.min(0),s.kI.max(100)],[]],companyName:[],nif:[],code:[],admin:[],name:[],surname:[],dni:[],version:[],email:["",[s.kI.required,s.kI.pattern(this.validatorsService.emailPattern)],[this.emailValidator]],password:["",[s.kI.required,s.kI.minLength(1)]],password2:["",[s.kI.required]]},{validators:[this.validatorsService.isFieldOneEqualFieldTwo("password","password2")]}),this.codes=[]}ngOnInit(){this.isPartnerRoute=this.router.url.includes("partner"),this.fetchCodigos()}fetchCodigos(){this.codeService.fetchCodigos().subscribe(t=>{this.codes=t},t=>{console.error(t),console.log("Error fetching active codes")})}isValidField(t){return this.validatorsService.isValidField(this.myForm,t)}getFieldError(t){if(!this.myForm.controls[t])return null;const i=this.myForm.controls[t].errors||{};for(const o of Object.keys(i))switch(o){case"required":return"Este campo es obligatorio";case"minlength":return`M\xednimo ${i.minlength.requiredLength} caracteres.`}return null}onSubmitClient(){const t=this.myForm.value,o={name:t.companyName,nif:t.nif,phone:t.phone,code:`/public/api/partner_codes/${t.code.id}`,active:!0,employees:t.employees,roles:t.admin?["ROLE_ADMIN"]:["ROLE_PARTNER"],joinDate:(new Date).toLocaleDateString("en-GB"),currentVersion:t.version};this.http.post("http://localhost:8080/public/clients",o).pipe((0,D.w)(r=>{const l=`/public/api/clients/${r.id}`,c={joinDate:(new Date).toLocaleDateString("en-GB"),client:l,version:t.version};return this.http.post("http://localhost:8080/public/clientVersion",c).pipe((0,O.U)(m=>({cliente:r,versionCliente:m})))})).subscribe(({cliente:r,versionCliente:l})=>{this.http.patch(`http://localhost:8080/public/clients/${r.id}`,{clientVersions:[`/public/api/client_versions/${l.id}`]}).subscribe(m=>{},m=>{console.error(m),console.log("Error updating Cliente with VersionCliente ID")})})}onSubmit(){const i={headers:new h.WM({"Content-Type":"application/merge-patch+json"}),withCredentials:!0},o=this.myForm.value,r={type:o.type,margin:Number(o.margin),name:o.companyName,nif:o.nif,phone:o.phone,active:!0,companies:0};this.http.post("http://localhost:8080/public/partners",r).pipe((0,D.w)(l=>{const c=`/public/api/partners/${l.id}`;return this.http.post("http://localhost:8080/public/partnerCode",{partner:c,code:o.nuevoCodigo}).pipe((0,D.w)(p=>{const b=`/public/api/partner_codes/${p.id}`;return this.http.post("http://localhost:8080/public/partnerEmail",{code:[b],email:o.warningEmails,clients:[],partnerEmails:[]}).pipe((0,D.w)(q=>this.http.post("http://localhost:8080/public/user",{name:o.name,surname:o.surname,email:o.email,password:o.password,partner:c,roles:o.admin?["ROLE_ADMIN"]:["ROLE_PARTNER"],dni:o.dni}).pipe((0,D.w)(B=>{const Z={name:o.companyName,nif:o.nif,phone:o.phone,code:b,active:!0,employees:o.employees,roles:o.admin?["ROLE_ADMIN"]:["ROLE_PARTNER"],joinDate:(new Date).toLocaleDateString("en-GB"),currentVersion:o.version};return this.http.post("http://localhost:8080/public/clients",Z).pipe((0,D.w)(ne=>{const Qn=`/public/api/clients/${ne.id}`,Rn={joinDate:(new Date).toLocaleDateString("en-GB"),client:Qn,version:o.version};return this.http.post("http://localhost:8080/public/clientVersion",Rn).pipe((0,O.U)($n=>({cliente:ne,versionCliente:$n,usuario:B,emailDistribuidor:q,codigoDistribuidor:p,distribuidor:l})))}))}))))}))})).subscribe(({cliente:l,versionCliente:c,usuario:m,emailDistribuidor:p,codigoDistribuidor:b,distribuidor:A})=>{this.http.patch(`http://localhost:8080/public/clients/${l.id}`,{clientVersions:[`/public/api/client_versions/${c.id}`]},i).subscribe(Z=>{},Z=>{console.error(Z),console.log("Error updating Cliente with VersionCliente ID")}),this.http.patch(`http://localhost:8080/public/partnerCode/${b.id}`,{partnerEmails:[`/public/api/partner_emails/${p.id}`]},i).subscribe(Z=>{},Z=>{console.error(Z),console.log("Error updating CodigoDistribuidor with EmailDistribuidor ID")}),this.http.patch(`http://localhost:8080/public/partners/${A.id}`,{users:[`/public/api/users/${m.id}`]},i).subscribe(Z=>{},Z=>{console.error(Z),console.log("Error updating Distribuidor with Usuario ID")})})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(s.qu),e.Y36(J),e.Y36(nn),e.Y36(h.eN),e.Y36(x.F0),e.Y36(te))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-nuevo-distribuidor"]],decls:6,vars:2,consts:[[1,"mat-card-no-border"],[4,"ngIf"],["autocomplete","off",1,"form-container",3,"formGroup","ngSubmit"],[1,"col-sm-3"],[1,"red-asterisk"],[1,"col-sm-9"],["appearance","outline"],["matInput","","type","text","formControlName","nuevoCodigo","placeholder","Nuevo c\xf3digo promocional"],["matInput","","type","text","formControlName","warningEmails","placeholder","Emails de aviso"],["formControlName","type","placeholder","Seleccione un valor"],["value","Partner"],["value","Partner Supra"],["value","Referenciador"],["matInput","","type","number","formControlName","margin","placeholder","Margen","min","0","max","100","step","1"],["matInput","","type","text","formControlName","companyName","placeholder","Nombre de la empresa"],["matInput","","type","text","formControlName","nif","placeholder","NIF de la empresa","pattern","\\d{8}[A-Z]"],["matInput","","type","tel","formControlName","phone","placeholder","Tel\xe9fono de contacto de la empresa"],["formControlName","code","placeholder","Seleccione un valor"],[3,"value",4,"ngFor","ngForOf"],["formControlName","version","placeholder","Seleccione un valor"],["value","Lite"],["value","Pro"],["matInput","","type","number","formControlName","employees","placeholder","Margen","min","0","max","100","step","1"],["matInput","","type","text","formControlName","billing","placeholder","Grupo de facturaci\xf3n"],["matInput","","type","text","formControlName","name","placeholder","Nombre del usuario"],["matInput","","type","text","formControlName","surname","placeholder","Apellidos del usuario"],["matInput","","type","text","formControlName","dni","placeholder","DNI del usuario"],["matInput","","type","email","formControlName","email","placeholder","Email del usuario"],["matInput","","type","password","formControlName","password","placeholder","Contrase\xf1a del usuario"],["matInput","","type","password","formControlName","password2","placeholder","Repita la contrase\xf1a"],[1,"col-sm-3","col-form-label"],["color","basic","id","flexCheckDefault","formControlName","admin"],["mat-raised-button","","color","primary",1,"mat-button","mat-button-wrapper","mr-2","green",2,"float","right"],[3,"value"]],template:function(t,i){1&t&&(e.TgZ(0,"h2"),e._uU(1,"Crear distribuidor"),e.qZA(),e.TgZ(2,"mat-card",0)(3,"mat-card-content"),e.YNc(4,Tn,204,19,"ng-container",1),e.YNc(5,En,73,9,"ng-container",1),e.qZA()()),2&t&&(e.xp6(4),e.Q6J("ngIf",!i.isPartnerRoute),e.xp6(1),e.Q6J("ngIf",i.isPartnerRoute))},dependencies:[_.sg,_.O5,Q.ey,v.lW,y.a8,y.dn,f.KE,f.hX,f.TO,M.Nt,R.gD,z.oG,s._Y,s.Fj,s.wV,s.JJ,s.JL,s.c5,s.qQ,s.Fd,s.sg,s.u],styles:[".form-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:20px}h2[_ngcontent-%COMP%]{margin-top:1%}h3[_ngcontent-%COMP%]{grid-column:1/-1;font-weight:700}  .mat-form-field-underline{display:none}.red-asterisk[_ngcontent-%COMP%]{color:red}[_nghost-%COMP%]{display:block;background-color:#f3f3f3;padding:20px}mat-card[_ngcontent-%COMP%]{box-shadow:none;border:none;outline:none}.mat-mdc-form-field-infix[_ngcontent-%COMP%]{width:50%}mat-form-field[_ngcontent-%COMP%]{width:100%}"]}),n})();function kn(n,a){1&n&&(e.ynx(0),e._UZ(1,"app-nuevo-distribuidor"),e.BQk())}function Mn(n,a){if(1&n&&(e.ynx(0),e._UZ(1,"app-dashboard",13),e.BQk()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("username",t.username)("role",t.role)}}const wn=function(n){return{expanded:n}};let Fn=(()=>{class n{toggleExpanded(){this.isExpanded=!this.isExpanded,this.isSidenavOpened=this.isExpanded}constructor(t,i,o,r){this.breakpointObserver=t,this.backend=o,this.authService=r,this.username="",this.role="",this.isExpanded=!1,this.isSidenavOpened=!0,this.isHandset$=this.breakpointObserver.observe("(min-width: 768px)").pipe((0,O.U)(l=>!l.matches),function re(n,a,t){let i,o=!1;return n&&"object"==typeof n?({bufferSize:i=1/0,windowTime:a=1/0,refCount:o=!1,scheduler:t}=n):i=n??1/0,(0,ae.B)({connector:()=>new oe(i,a,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:o})}()),this.router=i}ngOnDestroy(){}openPrivacyPage(){window.open("https://hrlog.es/privacidad/","_blank")}openSDIPage(){window.open("https://www.sdi.es/","_blank")}openHRLOGPage(){window.open("https://hrlog.es/","_blank")}ngOnInit(){this.userEmail=this.authService.getUserEmail()||"",this.userName=this.authService.getUserName()||"",this.surname=this.authService.getUserSurname()||""}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(g.Yg),e.Y36(x.F0),e.Y36(E),e.Y36(j.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-navigation"]],inputs:{username:"username",role:"role"},decls:23,vars:13,consts:[[1,"toolbar-container"],[1,"white"],["type","button","aria-label","Toggle sidenav","mat-icon-button","",3,"click"],["aria-label","Side nav toggle icon"],[3,"ngClass"],["fixedInViewport","",1,"sidenav","grey",3,"mode","opened"],["drawer",""],["mat-list-item","","href","#",2,"background-color","rgb(134, 188, 38)","text-align","center"],["mat-list-item",""],[1,"fa-solid","fa-gauge-high",2,"color","#7cb73b","margin-left","1rem","padding-right","4px"],["mat-button","",2,"color","rgb(134, 188, 38)",3,"click"],[1,"custom-sidenav-content"],[4,"ngIf"],[3,"username","role"]],template:function(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",0)(1,"mat-toolbar",1)(2,"button",2),e.NdJ("click",function(){e.CHM(o);const l=e.MAs(7);return e.KtG(l.toggle())}),e.TgZ(3,"mat-icon",3),e._uU(4,"menu"),e.qZA()()()(),e.TgZ(5,"mat-sidenav-container",4)(6,"mat-sidenav",5,6),e.ALo(8,"async"),e._UZ(9,"mat-toolbar"),e.TgZ(10,"mat-nav-list")(11,"a",7),e._uU(12),e._UZ(13,"br"),e._uU(14),e.qZA(),e.TgZ(15,"div",8),e._UZ(16,"i",9),e.TgZ(17,"button",10),e.NdJ("click",function(){return i.toggleExpanded()}),e._uU(18,"Dashboard"),e.qZA()()()(),e.TgZ(19,"mat-sidenav-content",11),e.YNc(20,kn,2,0,"ng-container",12),e.YNc(21,Mn,2,2,"ng-container",12),e._UZ(22,"mat-divider"),e.qZA()()}2&t&&(e.xp6(5),e.Q6J("ngClass",e.VKq(11,wn,i.isExpanded)),e.xp6(1),e.Q6J("mode","side")("opened",i.isSidenavOpened),e.uIk("role",e.lcZ(8,9,i.isHandset$)?"dialog":"navigation"),e.xp6(6),e.AsE(" ",i.userName," ",i.surname," "),e.xp6(2),e.hij(" ",i.userEmail,""),e.xp6(6),e.Q6J("ngIf","/panel/admin/nuevoPartner"===i.router.url||"/panel/partner/nuevaEmpresa"===i.router.url),e.xp6(1),e.Q6J("ngIf",!i.router.url.includes("/nuevoPartner")&&!i.router.url.includes("/nuevaEmpresa")))},dependencies:[_.mk,_.O5,v.lW,v.RK,P.Hw,H.Hk,H.Tg,k.d,Y.JX,Y.TM,Y.Rh,le.Ye,Wt,$,_.Ov],styles:[".toolbar-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;z-index:1000}.sidenav-container[_ngcontent-%COMP%]{margin-top:64px}@media (max-width: 690px){.mat-sidenav[_ngcontent-%COMP%]{display:none}}.sidenav-container.expanded[_ngcontent-%COMP%]{height:100%}.white[_ngcontent-%COMP%]{background-color:#fff}.mat-sidenav-content[_ngcontent-%COMP%]{overflow-y:hidden}.center-text[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}mat-sidenav[_ngcontent-%COMP%]{max-width:20%}.button-sdi[_ngcontent-%COMP%]{padding-left:5px;padding-right:5px}.btn-privacy[_ngcontent-%COMP%], .btn-hrlog[_ngcontent-%COMP%], .btn-sdi[_ngcontent-%COMP%]{min-width:auto;padding:0;margin:0}.fa-copyright[_ngcontent-%COMP%]{margin-right:2px}.copyright[_ngcontent-%COMP%]{float:right}"]}),n})();const Sn=[{path:"",component:(()=>{class n{constructor(t){this.route=t,this.username="",this.role=""}ngOnInit(){this.route.paramMap.subscribe(t=>{this.username=null!==t.get("username")?t.get("username"):"",this.role=null!==t.get("role")?t.get("role"):""})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(x.gz))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-layout-page"]],decls:1,vars:2,consts:[[3,"username","role"]],template:function(t,i){1&t&&e._UZ(0,"app-navigation",0),2&t&&e.Q6J("username",i.username)("role",i.role)},dependencies:[Fn],encapsulation:2}),n})(),children:[{path:"nuevoPartner",component:$},{path:"nuevaEmpresa",component:$}]},{path:"**",redirectTo:"list"}];let In=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[x.Bz.forChild(Sn),x.Bz]}),n})();var On=d(8565);let Yn=(()=>{class n extends w.ye{constructor(){super(...arguments),this.itemsPerPageLabel="Resultados por p\xe1gina",this.verLabel="Ver"}}return n.\u0275fac=function(){let a;return function(i){return(a||(a=e.n5z(n)))(i||n)}}(),n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})(),Jn=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({providers:[{provide:w.ye,useClass:Yn}],imports:[_.ez,In,On.q,s.UX]}),n})()}}]);